Exportfile for AOT version 1.0 or later
Formatversion: 1

***Element: FRM

; 
; --------------------------------------------------------------------------------
FRMVERSION 12

FORM #ProjInvoiceProposal
  PROPERTIES
    Name                #ProjInvoiceProposal
    Origin              #{9C6E75C7-3D1C-4C54-8AD6-FB388400153A}
  ENDPROPERTIES
  
  METHODS
    SOURCE #classDeclaration
      #class FormRun extends ObjectRun
      #{
      #    ProjInvoiceTable        projInvoiceTable;
      #
      #    QueryBuildRange         criteriaLineProperty;
      #    QueryBuildRange         criteriaLineProperty2;
      #    QueryBuildRange         criteriaLineProperty3;
      #    PSAContractLineNum      contractLineNum;
      #    QueryBuildRange         criteriaRetention;
      #
      #    Map                     closeLine;
      #    ProjInvoiceProjId       projInvoiceProjId;
      #    ProjId                  projId;
      #    ProjType                projType;
      #
      #    QueryBuildRange         criteriaInvoiceProjId;
      #
      #    QueryBuildRange         criteriaProposalId;
      #    str                     proposalId;
      #
      #    boolean                 setQueryRange;
      #    boolean                 setTransactionRange;
      #
      #    Object                  tmpTaxTransForm;
      #
      #    boolean                 showAll;
      #    boolean                 jumpToMain;
      #
      #    SysLastValue            sysLastValue;
      #    Common                  callerRecord;
      #
      #    ProjTransType           parmProjTransType;
      #    boolean                 parmIsItemTransTypeSales;
      #    boolean                 parmIsRevTransOriginSubscription;
      #    SysAnyType              parmSysAnyTypeTransId;
      #    ProjTransIdBase         parmTransId;
      #
      #    boolean                 projTransTypeEmpl;
      #    boolean                 projTransTypeCost;
      #    boolean                 projTransTypeItem;
      #    boolean                 projTransTypeRevenue;
      #    boolean                 projTransTypeSubscription;
      #    boolean                 projTransTypeOnAcc;
      #    boolean                 projTransTypeSales;
      #    TransDate               toDate;
      #    TransDate               fromDate;
      #
      #    boolean                 calledFromInvControl;
      #
      #    PSAProjInvoiceDetailLine    psaProjInvoiceDetailLine;
      #    ProjProposalRevenue         projProposalRevenuel;
      #
      #    #define.CurrentVersion(1)
      #    #localmacro.CurrentList
      #        showAll
      #    #endmacro
      #
      #    // <GEEU>
      #    #IsoCountryRegionCodes
      #    boolean                 countryRegion_LTLV;
      #    // </GEEU>
      #}
    ENDSOURCE
    SOURCE #calledFromInvControl
      #public boolean calledFromInvControl()
      #{
      #    return calledFromInvControl;
      #}
    ENDSOURCE
    SOURCE #callerDataRecord
      #Common callerDataRecord()
      #{
      #    return callerRecord;
      #}
    ENDSOURCE
    SOURCE #canSubmitToWorkflow
      #
      #public boolean canSubmitToWorkflow()
      #{
      #    boolean wfChk = false;
      #
      #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #    {
      #        wfChk = projProposalJour.canSubmitToWorkflow();
      #    }
      #
      #    return wfChk;
      #}
      #
      #
    ENDSOURCE
    SOURCE #close
      #public void close()
      #{
      #    super();
      #
      #    if (!jumpToMain)
      #    {
      #        showAll = ctrlActiveAll.selection() == ProjActiveAll::All;
      #        xSysLastValue::saveLast(this);
      #    }
      #}
    ENDSOURCE
    SOURCE #contractLineNum
      #PSAContractLineNum contractLineNum()
      #{
      #    return contractLineNum;
      #}
      #
      #
    ENDSOURCE
    SOURCE #executeQuery
      #public void executeQuery()
      #{
      #    projProposalJour_DS.executeQuery();
      #}
    ENDSOURCE
    SOURCE #fillInvoiceFormatCombo
      #void fillInvoiceFormatCombo()
      #{
      #    if (!isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #    {
      #        return;
      #    }
      #
      #    select firstonly projProposalRevenuel where projProposalRevenuel.ProposalId == projProposalJour.ProposalId;
      #    select firstonly RecId from psaProjInvoiceDetailLine where psaProjInvoiceDetailLine.ProposalId == projProposalJour.ProposalId;
      #
      #    projProposalJour_InvoiceFormats.clear();
      #    if (projProposalRevenuel && projProposalRevenuel.IsRetained)
      #    {
      #        projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::DetailInvoice));
      #    }
      #    else
      #    {
      #        if (PSAContractLineItems::hasBillingRules(projProposalJour.ProjInvoiceProjId))
      #        {
      #            projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::DetailInvoice));
      #        }
      #        else
      #        {
      #            projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::DetailInvoice));
      #            projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::SummaryInvoice));
      #            projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::SummaryByCategory));
      #        }
      #        if (psaProjInvoiceDetailLine.RecId != 0)
      #        {
      #            projProposalJour_InvoiceFormats.add(enum2str(PSAInvoiceFormats::ManageInvoice));
      #        }
      #    }
      #}
    ENDSOURCE
    SOURCE #fromDate
      #public TransDate fromDate()
      #{
      #    return  fromDate;
      #}
      #
    ENDSOURCE
    SOURCE #getShowTax
      #public Tax getShowTax()
      #{
      #    ProjProposalTotals projProposalTotals;
      #
      #    projProposalTotals = new ProjProposalTotals(projProposalJour);
      #    projProposalTotals.calc();
      #
      #    return projProposalTotals.tax();
      #}
    ENDSOURCE
    SOURCE #init
      #void init()
      #{
      #    //form has been deprecated
      #    throw error(Error::wrongUseOfFunction(funcName()));
      #    /*
      #    closeLine       = new Map(Types::Int64,Types::Integer);
      #    setQueryRange   = true;
      #
      #    super();
      #
      #    jumpToMain = (element.args().parm() == 'jumptomain') ? true : false;
      #
      #    if (!jumpToMain)
      #    {
      #        xSysLastValue::getLast(this);
      #    }
      #    else
      #    {
      #        this.parseJumpToMainParms();
      #    }
      #
      #    if (showAll || jumpToMain)
      #    {
      #        ctrlActiveAll.selection(ProjActiveAll::All);
      #    }
      #    else
      #    {
      #        ctrlActiveAll.selection(ProjActiveAll::Active);
      #    }
      #
      #    if (element.args().dataset())
      #    {
      #        callerRecord    = element.args().record();
      #    }
      #
      #    if (isConfigurationkeyEnabled(configurationkeynum(Project3)))
      #    {
      #        if (element.args().caller()!= null)
      #        {
      #            if (element.args().caller().name() == formstr(PSAProjProposalSelection)
      #               || element.args().caller().name() == classStr(PSARetenetionRelease))
      #            {
      #                if (element.args().caller().parmProjId())
      #                {
      #                    projId = element.args().caller().parmProjId();
      #                }
      #                if (element.args().caller().parmProjInvoiceProjId())
      #                {
      #                    projInvoiceProjId = element.args().caller().parmProjInvoiceProjId();
      #                }
      #            }
      #        }
      #
      #        if (PSAParameters::find().ApprActiveInvoiceProposal)
      #        {
      #            PSASubmitted.visible(true);
      #        }
      #        element.fillInvoiceFormatCombo();
      #
      #        if (isConfigurationKeyEnabled(configurationKeyNum(PSAIndirectCost)))
      #        {
      #            PSAIndirecCostAmount.visible(true);
      #        }
      #
      #        CtrlCreateProposal.visible(false);
      #        CtrlCreateOnAccount.visible(false);
      #        CtrlApprove.visible(false);
      #        CtrlCancelApprove.visible(false);
      #        CtrlInvoiceUpdate.visible(false);
      #
      #        ProjProposalJour_InvoiceAccount.visible(false);
      #        ProjectInvoiceProposaleJour_InvoiceType.visible(false);
      #        ProjectInvoiceProposalJour_LedgerVoucher.visible(false);
      #    }
      #    else
      #    {
      #        PSAbtPrintPreview.visible(false);
      #    }
      #    // <GEEU>
      #    countryRegion_LTLV = SysCountryRegionCode::isLegalEntityInCountryRegion([#isoLT, #isoLV]);
      #    // </GEEU>
      #    */
      #}
    ENDSOURCE
    SOURCE #initDesign_LT
      #// <GEEU>
      #void initDesign_LT(boolean isEditable = true)
      #{
      #    projProposalJour_DS.allowEdit(true);
      #
      #    allowEditFieldsOnFormDS_W(projProposalJour_DS, false);
      #
      #    prijInvoiceProposalGrid.allowEdit(true);
      #
      #    projProposalJour_DS.object(fieldNum(ProjProposalJour, InvoiceAutoNumbering_LT)).allowEdit(isEditable);
      #}
      #// </GEEU>
    ENDSOURCE
    SOURCE #initParmDefault
      #void initParmDefault()
      #{
      #}
      #
      #
    ENDSOURCE
    SOURCE #lastValueDataAreaId
      #DataAreaId lastValueDataAreaId()
      #{
      #    return curext();
      #}
      #
      #
    ENDSOURCE
    SOURCE #lastValueDesignName
      #IdentifierName lastValueDesignName()
      #{
      #    return '';
      #}
      #
      #
    ENDSOURCE
    SOURCE #lastValueElementName
      #IdentifierName lastValueElementName()
      #{
      #    return this.name();
      #}
      #
      #
    ENDSOURCE
    SOURCE #lastValueType
      #UtilElementType lastValueType()
      #{
      #    return UtilElementType::Form;
      #}
      #
      #
    ENDSOURCE
    SOURCE #lastValueUserId
      #UserId lastValueUserId()
      #{
      #    return curUserId();
      #}
      #
      #
    ENDSOURCE
    SOURCE #pack
      #public container pack()
      #{
      #    return [#CurrentVersion,#CurrentList];
      #}
      #
      #
    ENDSOURCE
    SOURCE #parseJumpToMainParms
      #private void parseJumpToMainParms()
      #{
      #    parmSysAnyTypeTransId = element.args().parmObject();
      #    parmTransId = parmSysAnyTypeTransId.value();
      #
      #    switch (element.args().parmEnumType())
      #    {
      #        case enumNum(ProjTransType):
      #            // If the enumtype is ProjTransType, the trans type are either Hour/Cost/OnAccount
      #            parmProjTransType = element.args().parmEnum();
      #            break;
      #
      #        case enumNum(ProjItemType):
      #            // If the enumtype is ProjItemType, the trans origin of Item trans type has been passed
      #            parmProjTransType = ProjTransType::Item;
      #            parmIsItemTransTypeSales = (element.args().parmEnum() == ProjItemType::SalesOrder);
      #            break;
      #
      #        case enumNum(ProjOriginRevenue):
      #            // If the enumtype is ProjOriginRevenue, the trans origin of Revenue trans type has been passed
      #            parmProjTransType = ProjTransType::Revenue;
      #            parmIsRevTransOriginSubscription = (element.args().parmEnum() == ProjOriginRevenue::SMASubscription);
      #            break;
      #
      #        default:
      #            break;
      #    }
      #}
    ENDSOURCE
    SOURCE #projId
      #ProjId projId()
      #{
      #    return projId;
      #}
      #
    ENDSOURCE
    SOURCE #projInvoiceProjId
      #ProjInvoiceProjId projInvoiceProjId()
      #{
      #    return projInvoiceProjId;
      #}
    ENDSOURCE
    SOURCE #projInvoiceTable
      #ProjInvoiceTable projInvoiceTable()
      #{
      #    return projInvoiceTable;
      #}
    ENDSOURCE
    SOURCE #projTransTypeCost
      #public boolean projTransTypeCost()
      #{
      #    return projTransTypeCost;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeEmpl
      #public boolean projTransTypeEmpl()
      #{
      #    return projTransTypeEmpl;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeItem
      #public boolean projTransTypeItem()
      #{
      #    return projTransTypeItem;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeOnAcc
      #public boolean projTransTypeOnAcc()
      #{
      #    return projTransTypeOnAcc;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeRevenue
      #public boolean projTransTypeRevenue()
      #{
      #    return projTransTypeRevenue;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeSales
      #public boolean projTransTypeSales()
      #{
      #    return projTransTypeSales;
      #}
      #
    ENDSOURCE
    SOURCE #projTransTypeSubscription
      #public boolean projTransTypeSubscription()
      #{
      #    return projTransTypeSubscription;
      #}
      #
    ENDSOURCE
    SOURCE #setAllowEdit
      #void setAllowEdit()
      #{
      #    if (projProposalJour)
      #    {
      #        if (projProposalJour.LineProperty   == ProjLinePropertyCode::Approved    ||
      #            projProposalJour.LineProperty   == ProjLinePropertyCode::Canceled    ||
      #            projProposalJour.LineProperty   == ProjLinePropertyCode::Invoiced)
      #        {
      #            projProposalEmpl_ds.allowDelete(false);
      #            projProposalOnAcc_ds.allowDelete(false);
      #            projProposalCost_ds.allowDelete(false);
      #            projProposalItem_SalesOrder_ds.allowDelete(false);
      #            projProposalItem_Project_ds.allowDelete(false);
      #            projProposalRevenue_ds.allowDelete(false);
      #            projProposalRevenueSubscription_ds.allowDelete(false);
      #            projProposalJour_ds.allowEdit(false);
      #            prijInvoiceProposalGrid.allowEdit(false);
      #        }
      #        else
      #        {
      #
      #            //turn them back on
      #            projProposalEmpl_ds.allowDelete(true);
      #            projProposalOnAcc_ds.allowDelete(true);
      #            projProposalCost_ds.allowDelete(true);
      #            projProposalItem_SalesOrder_ds.allowDelete(true);
      #            projProposalItem_Project_ds.allowDelete(true);
      #            projProposalRevenue_ds.allowDelete(true);
      #            projProposalRevenueSubscription_ds.allowDelete(true);
      #            projProposalJour_ds.allowEdit(true);
      #
      #            if (CustTable::isCustDKPublic(projProposalJour.InvoiceAccount) == NoYes::Yes)
      #            {
      #                prijInvoiceProposalGrid.allowEdit(true);
      #                projectInvoiceProposalJour_CurrencyCode.allowEdit(false);
      #
      #                if (projProposalJour.eInvoiceLineSpecific == NoYes::No)
      #                {
      #                    projProposalJour_EInvoiceAccountCode.enabled(true);
      #                }
      #                else
      #                {
      #                    projProposalJour_EInvoiceAccountCode.enabled(false);
      #                }
      #            }
      #            else
      #            {
      #                prijInvoiceProposalGrid.allowEdit(false);
      #                if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #                {
      #                    prijInvoiceProposalGrid.allowEdit(true);
      #                }
      #            }
      #        }
      #    }
      #}
    ENDSOURCE
    SOURCE #setButtonAccess
      #void setButtonAccess()
      #{
      #    boolean chk;
      #
      #    if (projType && projType == ProjType::FixedPrice)
      #    {
      #        ctrlCreateProposal.enabled(false);
      #    }
      #    else
      #    {
      #        ctrlCreateProposal.enabled(true);
      #    }
      #    ctrlCreateOnAccount.enabled(true);
      #
      #    if (projProposalJour && !projProposalJour.ProjInvoiceId)
      #    {
      #        ctrlUpdateProposal.enabled(true);
      #        ctrlCancel.enabled(true);
      #        ctrlInvoiceUpdate.enabled(true);
      #        ctrlCourse.enabled(true);
      #        ctrlTax.enabled(true);
      #        ctrlTotals.enabled(true);
      #        ctrlPaymentSchedule.enabled( projProposalJour.PaymentSched != "" );
      #        if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #        {
      #            if(projProposalJour.LineProperty == ProjLinePropertyCode::Canceled)
      #            {
      #                psaProjInvoiceDetails.enabled(false);
      #            }
      #            else
      #            {
      #                psaProjInvoiceDetails.enabled(true);
      #            }
      #        }
      #    }
      #    else
      #    {
      #        if (!jumpToMain && !parmSysAnyTypeTransId)
      #        {
      #            heading.tab(1);
      #        }
      #
      #        ctrlUpdateProposal.enabled(false);
      #        ctrlCancel.enabled(false);
      #        ctrlInvoiceUpdate.enabled(false);
      #        ctrlCourse.enabled(false);
      #        if (projProposalJour.ProjInvoiceId)
      #        {
      #            ctrlTotals.enabled(true);
      #            ctrlPaymentSchedule.enabled(true);
      #            ctrlTax.enabled(true);
      #        }
      #        else
      #        {
      #            ctrlTotals.enabled(false);
      #            ctrlPaymentSchedule.enabled(false);
      #            ctrlTax.enabled(false);
      #        }
      #
      #        element.setAllowEdit();
      #        if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #        {
      #            psaProjInvoiceDetails.enabled(false);
      #        }
      #
      #        return;
      #    }
      #
      #    if (!ProjParameters::find().ApproveActive)
      #    {
      #        ctrlUpdateProposal.enabled(true);
      #        if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #        {
      #            chk = projProposalJour.LineProperty == ProjLinePropertyCode::Canceled
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::Invoiced
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::Open
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::Approved
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::PSASubmitted
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::PSARejected;
      #        }
      #        else
      #        {
      #            chk = projProposalJour.LineProperty == ProjLinePropertyCode::Canceled
      #                  || projProposalJour.LineProperty == ProjLinePropertyCode::Invoiced;
      #        }
      #        if (chk)
      #        {
      #            ctrlInvoiceUpdate.enabled(false);
      #        }
      #        else
      #        {
      #            ctrlInvoiceUpdate.enabled(true);
      #        }
      #        ctrlCourse.visible(false);
      #    }
      #    else
      #    {
      #
      #        if (UserInfoHelp::userInUserGroup(curUserId(), ProjParameters::find().ApproveGroupId))
      #        {
      #            ctrlCourse.enabled(true);
      #        }
      #        else
      #        {
      #            ctrlCourse.enabled(false);
      #        }
      #
      #        if (projProposalJour.LineProperty == ProjLinePropertyCode::Canceled ||
      #            projProposalJour.LineProperty == ProjLinePropertyCode::Invoiced)
      #        {
      #            ctrlCourse.enabled(false);
      #        }
      #        else
      #        {
      #
      #            ctrlApprove.enabled(true);
      #
      #            if (projProposalJour.LineProperty == ProjLinePropertyCode::Approved)
      #            {
      #                ctrlApprove.enabled(false);
      #                ctrlCancel.enabled(true);
      #                ctrlCancelApprove.enabled(true);
      #            }
      #
      #        }
      #
      #        switch (projProposalJour.LineProperty)
      #        {
      #            case ProjLinePropertyCode::Open :
      #                ctrlInvoiceUpdate.enabled(false);
      #                ctrlUpdateProposal.enabled(true);
      #                ctrlCancel.enabled(true);
      #                break;
      #
      #            case ProjLinePropertyCode::Canceled :
      #                ctrlInvoiceUpdate.enabled(false);
      #                ctrlUpdateProposal.enabled(false);
      #                if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #                {
      #                    ctrlCancel.enabled(true);
      #                }
      #                else
      #                {
      #                    ctrlCancel.enabled(false);
      #                }
      #                break;
      #
      #            case ProjLinePropertyCode::Invoiced :
      #                ctrlInvoiceUpdate.enabled(false);
      #                ctrlUpdateProposal.enabled(false);
      #                ctrlCancel.enabled(false);
      #                break;
      #
      #            case ProjLinePropertyCode::Approved :
      #                ctrlInvoiceUpdate.enabled(true);
      #                ctrlUpdateProposal.enabled(false);
      #                ctrlCancel.enabled(true);
      #                break;
      #
      #            case ProjLinePropertyCode::PSASubmitted:
      #                if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #                {
      #                    ctrlInvoiceUpdate.enabled(false);
      #                    ctrlUpdateProposal.enabled(false);
      #                    ctrlCancel.enabled(false);
      #                }
      #                break;
      #
      #            case ProjLinePropertyCode::PSARejected:
      #                if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #                {
      #                    ctrlInvoiceUpdate.enabled(false);
      #                    ctrlUpdateProposal.enabled(true);
      #                    ctrlCancel.enabled(true);
      #                }
      #                break;
      #        }
      #    }
      #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
      #    {
      #        if (projProposalJour && projProposalJour.LineProperty == ProjLinePropertyCode::Open)
      #        {
      #            ctrlCancel.enabled(true);
      #        }
      #        else
      #        {
      #            ctrlCancel.enabled(false);
      #        }
      #    }
      #
      #    //duplicated immediately prior to return statement in the body of the method
      #    element.setAllowEdit();
      #}
    ENDSOURCE
    SOURCE #setFieldAccess
      #void setFieldAccess()
      #{
      #    if (projProposalJour.ProjInvoiceId)
      #    {
      #        projProposalEmpl_ds.allowEdit(false);
      #        projProposalOnAcc_ds.allowEdit(false);
      #        projProposalCost_ds.allowEdit(false);
      #        projProposalRevenue_ds.allowEdit(false);
      #        projProposalItem_Project_ds.allowEdit(false);
      #        projProposalRevenueSubscription_ds.allowEdit(false);
      #    }
      #    else
      #    {
      #        projProposalEmpl_ds.allowEdit(true);
      #        projProposalOnAcc_ds.allowEdit(true);
      #        projProposalCost_ds.allowEdit(true);
      #        projProposalRevenue_ds.allowEdit(true);
      #        projProposalItem_Project_ds.allowEdit(true);
      #        projProposalRevenueSubscription_ds.allowEdit(true);
      #    }
      #    if (isConfigurationkeyEnabled(configurationKeyNum(PSAARRetainage)))
      #    {
      #        if (projOnAccTrans)
      #        {
      #            if (projOnAccTrans.TransactionOrigin == ProjOrigin::Deduction
      #                && projOnAccTrans.psaIsOnAccount)
      #            {
      #                psaProjProposalProj_RetainedNow.visible(true);
      #                psaProjProposalProj_RetainedPercent.visible(true);
      #            }
      #            else if(projOnAccTrans.TransactionOrigin == ProjOrigin::Prepayment
      #                    && projOnAccTrans.psaIsOnAccount)
      #            {
      #                psaProjProposalProj_RetainedNow.visible(false);
      #                psaProjProposalProj_RetainedPercent.visible(false);
      #                psaProjProposalProj_ReleasedAmount.visible(false);
      #            }
      #            else
      #            {
      #                psaProjProposalProj_RetainedNow.visible(true);
      #                psaProjProposalProj_RetainedPercent.visible(true);
      #                psaProjProposalProj_ReleasedAmount.visible(false);
      #            }
      #        }
      #        else
      #        {
      #            psaProjProposalProj_RetainedNow.visible(true);
      #            psaProjProposalProj_RetainedPercent.visible(true);
      #            psaProjProposalProj_ReleasedAmount.visible(projProposalRevenue.IsReleased);
      #            psaProjProposalProj_RetainedNow.visible(!projProposalRevenue.IsReleased);
      #            psaProjProposalProj_RetainedPercent.visible(!projProposalRevenue.IsReleased);
      #        }
      #
      #        if (!projProposalRevenue.IsReleased
      #            && psaProjProposalProj.RetainedNow < 0)
      #        {
      #            psaProjProposalProj_RetainedNow.allowEdit(false);
      #            psaProjProposalProj_RetainedPercent.allowEdit(false);
      #        }
      #        else
      #        {
      #            psaProjProposalProj_RetainedNow.allowEdit(true);
      #            psaProjProposalProj_RetainedPercent.allowEdit(true);
      #        }
      #    }
      #}
    ENDSOURCE
    SOURCE #setProjTableFilter
      #void setProjTableFilter()
      #{
      #    QueryBuildDataSource    projProposalTransUnionDataSource;
      #    projProposalTransUnionDataSource = projProposalJour_ds.query().dataSourceNo(1).addDataSource(tableNum(ProjProposalTransUnion));
      #    projProposalTransUnionDataSource.addLink(fieldNum(ProjProposalJour, ProposalId), fieldNum(ProjProposalTransUnion, ProposalId));
      #    projProposalTransUnionDataSource.addRange(fieldNum(ProjProposalTransUnion, ProjId)).value(projId);
      #    projProposalTransUnionDataSource.joinMode(JoinMode::ExistsJoin);
      #}
    ENDSOURCE
    SOURCE #toDate
      #public TransDate toDate()
      #{
      #    return toDate;
      #}
      #
    ENDSOURCE
    SOURCE #unpack
      #public boolean unpack(container packedClass)
      #{
      #    Integer version     = conPeek(packedClass,1);
      #
      #    switch (version)
      #    {
      #        case #CurrentVersion :
      #            [version,#CurrentList] = packedClass;
      #            break;
      #
      #        default :
      #            return false;
      #    }
      #
      #    return true;
      #}
      #
      #
    ENDSOURCE
    SOURCE #updatedRecs
      #Map updatedRecs(Args     args)
      #{
      #    Map                 updatedRecs;
      #    FormDataSource      formDataSource;
      #    ProjCostTrans       projCostTransDS;
      #    ProjCostTrans       projCostTransNew;
      #    ProjEmplTrans       projEmplTransNew;
      #    ProjEmplTrans       projEmplTransDS;
      #    ProjItemTrans       projItemTransDS;
      #    ProjItemTrans       projItemTransNew;
      #    ProjOnAccTrans      projOnAccTransDS;
      #    ProjOnAccTrans      projOnAccTransNew;
      #    ProjRevenueTrans    projRevenueTransDS;
      #    ProjRevenueTrans    projRevenueTransNew;
      #
      #    updatedRecs = new Map(Types::Int64,Types::Record);
      #    formDataSource  = args.record().dataSource();
      #
      #    switch(args.dataset())
      #    {
      #        case tableNum(ProjCostTrans):
      #            projCostTransDS   = args.record();
      #            for (projCostTransDS = formDataSource.getFirst(true) ?
      #                 formDataSource.getFirst(true) : formDataSource.cursor();
      #                 projCostTransDS; projCostTransDS = formDataSource.getNext())
      #            {
      #                projCostTransNew   = ProjCostTrans::find(projCostTransDS.TransId);
      #                updatedRecs.insert(projCostTransNew.RecId,projCostTransNew);
      #            }
      #            break;
      #
      #        case tableNum(ProjEmplTrans):
      #            projEmplTransDS   = args.record();
      #            for (projEmplTransDS = formDataSource.getFirst(true) ?
      #                 formDataSource.getFirst(true) : formDataSource.cursor();
      #                 projEmplTransDS; projEmplTransDS = formDataSource.getNext())
      #            {
      #                projEmplTransNew   = ProjEmplTrans::find(projEmplTransDS.TransId);
      #                updatedRecs.insert(projEmplTransNew.RecId,projEmplTransNew);
      #            }
      #            break;
      #
      #        case tableNum(ProjItemTrans):
      #            projItemTransDS   = args.record();
      #            for (projItemTransDS = formDataSource.getFirst(true) ?
      #                 formDataSource.getFirst(true) : formDataSource.cursor();
      #                 projItemTransDS; projItemTransDS = formDataSource.getNext())
      #            {
      #                projItemTransNew   = ProjItemTrans::find(projItemTransDS.ProjTransId);
      #                updatedRecs.insert(projItemTransNew.RecId,projItemTransNew);
      #            }
      #            break;
      #
      #        case tableNum(ProjOnAccTrans):
      #            projOnAccTransDS   = args.record();
      #            for (projOnAccTransDS = formDataSource.getFirst(true) ?
      #                 formDataSource.getFirst(true) : formDataSource.cursor();
      #                 projOnAccTransDS; projOnAccTransDS = formDataSource.getNext())
      #            {
      #                projOnAccTransNew   = ProjOnAccTrans::find(projOnAccTransDS.TransId);
      #                updatedRecs.insert(projOnAccTransNew.RecId,projOnAccTransNew);
      #            }
      #            break;
      #
      #        case tableNum(ProjRevenueTrans):
      #            projRevenueTransDS   = args.record();
      #            for (projRevenueTransDS = formDataSource.getFirst(true) ?
      #                 formDataSource.getFirst(true) : formDataSource.cursor();
      #                 projRevenueTransDS; projRevenueTransDS = formDataSource.getNext())
      #            {
      #                projRevenueTransNew   = ProjRevenueTrans::find(projRevenueTransDS.TransId);
      #                updatedRecs.insert(projRevenueTransNew.RecId,projRevenueTransNew);
      #            }
      #            break;
      #    }
      #
      #    return updatedRecs;
      #}
    ENDSOURCE
    SOURCE #updateRelatedForm
      #// If called from a single transaction update related transaction
      #void updateRelatedForm()
      #{
      #    FormRun             callerForm  = element.args().caller();
      #    FormDataSource      fds;
      #    Args                argsTrans = new Args();
      #    Map                 updatedRecs;
      #
      #    if ((element.args().caller() != null)
      #        && (element.args().caller().name() != formStr(projProjectTransactionsListPage))
      #        && (element.args().caller().name() != formStr(projGrantTransListPage)))
      #    {
      #        // Do not update datasource when caller form Posted Transactions List Page and Grant transactions List Page
      #        argsTrans.record(element.args().record());
      #
      #        if (argsTrans.record())
      #        {
      #            updatedRecs     = element.updatedRecs(argsTrans);
      #
      #            if (updatedRecs)
      #            {
      #                RunBaseMultiParm::formCacheUpdate(callerForm,element.args().record(),updatedRecs.pack());
      #                fds = element.args().record().dataSource();
      #                fds.active();
      #            }
      #        }
      #    }
      #}
    ENDSOURCE
  ENDMETHODS
  OBJECTBANK
    PROPERTIES
    ENDPROPERTIES
    
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalJour
          Table               #ProjProposalJour
          Index               #ProposalNumIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          StartPosition       #Last
          LinkType            #Active
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD EInvoiceAccountCode
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #
                #    this.allowEdit(true);
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #write
          #public void write()
          #{
          #    super();
          #
          #    if(TaxParameters::find().CashDiscOnInvoice)
          #    {
          #        if(projProposalJour.CashDiscCode &&
          #            projProposalJour.InvoiceAmount < 0)
          #        {
          #            info("@SYS99050");
          #        }
          #    }
          #    if (CustParameters::isTaxIntegrationSystem_CN())
          #    {
          #        projProposalJourExtensionCN.ProjProposalJour = projProposalJour.RecId;
          #        projProposalJourExtensionCN_ds.write();
          #    }
          #}
          #
          #
          #
        ENDSOURCE
        SOURCE #linkActive
          #void linkActive()
          #{
          #    #define.star("*")
          #    ProjTable               projTable;
          #    ProjInvoiceControl      projInvoiceControl;
          #    SMAServiceOrderTable    smaServiceOrderTable;
          #
          #    switch (element.args().record().TableId)
          #    {
          #        case (tableNum(ProjCostTrans)):
          #        case (tableNum(ProjEmplTrans)):
          #        case (tableNum(ProjRevenueTrans)):
          #        case (tableNum(ProjItemTrans)):
          #        case (tableNum(ProjOnAccTrans)):
          #            setTransactionRange  = true;
          #            break;
          #
          #        case (tableNum(ProjInvoiceTable)):
          #            projInvoiceTable     = element.args().record();
          #            projInvoiceProjId    = projInvoiceTable.ProjInvoiceProjId;
          #            setQueryRange        = true;
          #            criteriaInvoiceProjId.value(projInvoiceProjId);
          #            break;
          #
          #        case (tableNum(ProjTable)):
          #            projTable            = element.args().record();
          #            projId               = projTable.ProjId;
          #            projType             = projTable.Type;
          #            projInvoiceProjId    = projTable.ProjInvoiceProjId;
          #            projInvoiceTable     = projTable.projInvoice();
          #            setQueryRange        = true;
          #            projId              += #star;
          #            element.setProjTableFilter();
          #            break;
          #
          #        case (tableNum(ProjInvoiceParmTable)):
          #            projInvoiceProjId    = projTable.ProjInvoiceProjId;
          #            setQueryRange        = true;
          #            criteriaInvoiceProjId.value(projInvoiceProjId);
          #            break;
          #
          #        case(tableNum(TmpProjInvoiceControl)):
          #            if (projInvoiceControl)
          #            {
          #                element.close();
          #            }
          #
          #            projInvoiceControl  = element.args().parmObject();
          #            if (projInvoiceControl.parmProjId())
          #            {
          #                projId              = projInvoiceControl.parmProjId();
          #                projInvoiceProjId   = ProjTable::find(projInvoiceControl.parmProjId()).ProjInvoiceProjId;
          #            }
          #            else
          #                projInvoiceProjId   = projInvoiceControl.parmProjInvoiceProjId();
          #
          #            criteriaInvoiceProjId.value(projInvoiceProjId);
          #
          #            projTransTypeEmpl           = projInvoiceControl.parmHour();
          #            projTransTypeCost           = projInvoiceControl.parmExpenses();
          #            projTransTypeItem           = projInvoiceControl.parmItem();
          #            projTransTypeRevenue        = projInvoiceControl.parmRevenue();
          #            projTransTypeSubscription   = projInvoiceControl.parmSubscription();
          #            projTransTypeOnAcc          = projInvoiceControl.parmOnAccount();
          #            projTransTypeSales          = projInvoiceControl.parmSalesLine();
          #            fromDate                    = projInvoiceControl.parmProjTransDateFrom();
          #            toDate                      = projInvoiceControl.parmProjTransDateTo();
          #
          #            calledFromInvControl        = true;
          #
          #            if (toDate == dateMax())
          #            {
          #                toDate = dateNull();
          #            }
          #            break;
          #
          #        case (tableNum(SMAServiceOrderTable)):
          #            smaServiceOrderTable = element.args().record();
          #            projTable            = ProjTable::find(smaServiceOrderTable.ProjId);
          #            projId               = projTable.ProjId;
          #            projInvoiceProjId    = projTable.ProjInvoiceProjId;
          #            setQueryRange        = true;
          #            criteriaInvoiceProjId.value(projInvoiceProjId);
          #            break;
          #
          #        default:
          #            setQueryRange        = false;
          #
          #    }
          #
          #    super();
          #
          #    element.setButtonAccess();
          #}
        ENDSOURCE
        SOURCE #init
          #void init()
          #{
          #    super();
          #
          #    criteriaLineProperty   = this.query().dataSourceNo(1).addRange(fieldNum(ProjProposalJour,LineProperty));
          #    criteriaLineProperty2  = this.query().dataSourceNo(1).addRange(fieldNum(ProjProposalJour,LineProperty));
          #    criteriaInvoiceProjId  = this.query().dataSourceNo(1).addRange(fieldNum(ProjProposalJour,ProjInvoiceProjId));
          #    criteriaProposalId     = this.query().dataSourceNo(1).addRange(fieldNum(ProjProposalJour,ProposalId));
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        criteriaLineProperty3  = this.query().dataSourceNo(1).addRange(fieldNum(ProjProposalJour,LineProperty));
          #    }
          #}
        ENDSOURCE
        SOURCE #executeQuery
          #void executeQuery()
          #{
          #    if (setQueryRange)
          #    {
          #        if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #        {
          #            switch (ctrlActiveAll.selection())
          #            {
          #            case PSAInvoiceProposalStatus::All :
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                criteriaLineProperty3.value('');
          #                break;
          #
          #            case PSAInvoiceProposalStatus::Submitted:
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                criteriaLineProperty3.value(SysQuery::value(ProjLinePropertyCode::PSASubmitted));
          #                break;
          #
          #            case PSAInvoiceProposalStatus::Approved:
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                criteriaLineProperty3.value(SysQuery::value(ProjLinePropertyCode::Approved));
          #                break;
          #
          #            case PSAInvoiceProposalStatus::Canceled:
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                criteriaLineProperty3.value(SysQuery::value(ProjLinePropertyCode::Canceled));
          #                break;
          #
          #            case PSAInvoiceProposalStatus::Invoiced:
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                criteriaLineProperty3.value(SysQuery::value(ProjLinePropertyCode::Invoiced));
          #                break;
          #
          #            case PSAInvoiceProposalStatus::Active:
          #                criteriaLineProperty.value(strFmt('%1',enum2Value(ProjLinePropertyCode::Open)));
          #                break;
          #
          #            }
          #        }
          #        else
          #        {
          #        switch (ctrlActiveAll.selection())
          #        {
          #            case ProjActiveAll::Active:
          #                criteriaLineProperty.value(strFmt('%1',enum2Value(ProjLinePropertyCode::Open)));
          #
          #                criteriaLineProperty2.value(strFmt('%1',enum2Value(ProjLinePropertyCode::Approved)));
          #                break;
          #
          #            case ProjActiveAll::All :
          #                criteriaLineProperty.value('');
          #                criteriaLineProperty2.value('');
          #                break;
          #        }
          #        }
          #
          #    }
          #
          #    if (setTransactionRange)
          #    {
          #        criteriaProposalId     = this.query().dataSourceNo(1).findRange(fieldNum(ProjProposalJour,ProposalId));
          #        this.transactionRange();
          #    }
          #
          #    super();
          #}
        ENDSOURCE
        SOURCE #active
          #int active()
          #{
          #    int ret;
          #
          #    ret  = super();
          #
          #    element.setButtonAccess();
          #    element.setFieldAccess();
          #
          #    if (tmpTaxTransForm && !tmpTaxTransForm.closed())
          #    {
          #        tmpTaxTransForm.pushTaxObject(element.getShowTax());
          #    }
          #
          #    if (CustTable::isCustDKPublic(projProposalJour.InvoiceAccount) == NoYes::Yes)
          #    {
          #        projProposalJour_EInvoiceLineSpecific.visible(true);
          #        projProposalJour_EInvoiceAccountCode.visible(true);
          #    }
          #    else
          #    {
          #        projProposalJour_EInvoiceLineSpecific.visible(false);
          #        projProposalJour_EInvoiceAccountCode.visible(false);
          #    }
          #
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        if (projProposalJour.LineProperty == ProjLinePropertyCode::Canceled
          #            || projProposalJour.LineProperty == ProjLinePropertyCode::Invoiced)
          #        {
          #            projProposalJour_ds.allowEdit(false);
          #            psaProjProposalProj_RetainedNow.enabled(false);
          #            psaProjProposalProj_RetainedPercent.enabled(false);
          #        }
          #        else
          #        {
          #            projProposalJour_ds.allowEdit(true);
          #            psaProjProposalProj_RetainedNow.enabled(true);
          #            psaProjProposalProj_RetainedPercent.enabled(true);
          #        }
          #
          #        if (projProposalOnAcc && (ProjTable::find(projOnAccTrans.ProjID).Type == ProjType::FixedPrice))
          #        {
          #            onAcc.caption("@PSA250");
          #        }
          #        else
          #        {
          #            onAcc.caption("@PSA11465");
          #        }
          #
          #        if (projProposalJour.LineProperty == ProjLinePropertyCode::Invoiced ||
          #            projProposalJour.LineProperty == ProjLinePropertyCode::Canceled)
          #        {
          #            psAbtPrintPreview.enabled(false);
          #        }
          #        else
          #        {
          #            psAbtPrintPreview.enabled(true);
          #        }
          #
          #        if (projProposalRevenue.IsReleased)
          #        {
          #            revenue.caption("@PSA11365");
          #        }
          #    }
          #
          #    // <GEEU>
          #    if (countryRegion_LTLV)
          #    {
          #        element.initDesign_LT(projProposalJour.LineProperty == ProjLinePropertyCode::Open);
          #    }
          #    // </GEEU>
          #    return ret;
          #}
        ENDSOURCE
        SOURCE #transactionRange
          #void transactionRange()
          #{
          #
          #    ProjCostTrans           projCostTransCaller;
          #    ProjCostTransSale       projCostTransSale;
          #    ProjEmplTrans           projEmplTransCaller;
          #    ProjEmplTransSale       projEmplTransSale;
          #    ProjItemTrans           projItemTransCaller;
          #    ProjItemTransSale       projItemTransSale;
          #    ProjOnAccTrans          projOnAccTransCaller;
          #    ProjOnAccTransSale      projOnAccTransSale;
          #    ProjRevenueTrans        projRevenueTransCaller;
          #    ProjRevenueTransSale    projRevenueTransSale;
          #    FormDataSource          formDataSource;
          #    ProjProposalId          tmpProjProposalId;
          #
          #    proposalId              = SysQuery::valueEmptyString();
          #    if (element.args().record().dataSource()) //if the calling record has a datasource then load the proposal id's from the calling record
          #    {
          #        switch (element.args().record().TableId)
          #        {
          #            case (tableNum(ProjCostTrans)):
          #                projCostTransCaller     = element.args().record();
          #                formDataSource          = projCostTransCaller.dataSource();
          #                for (projCostTransCaller = formDataSource.getFirst(true) ?
          #                     formDataSource.getFirst(true) : formDataSource.cursor();
          #                     projCostTransCaller; projCostTransCaller = formDataSource.getNext())
          #                {
          #                    while select projCostTransSale
          #                        where projCostTransSale.TransId == projCostTransCaller.TransId
          #                    {
          #                        tmpProjProposalId = projCostTransSale.proposalId();
          #                        if (tmpProjProposalId)
          #                        {
          #                            if (proposalId == SysQuery::valueEmptyString())
          #                            {
          #                                proposalId = tmpProjProposalId;
          #                            }
          #                            else
          #                            {
          #                                proposalId = proposalId+','+tmpProjProposalId;
          #                            }
          #                        }
          #                    }
          #                }
          #                break;
          #
          #            case (tableNum(ProjEmplTrans)):
          #                projEmplTransCaller     = element.args().record();
          #                formDataSource          = projEmplTransCaller.dataSource();
          #                for (projEmplTransCaller = formDataSource.getFirst(true) ?
          #                     formDataSource.getFirst(true) : formDataSource.cursor();
          #                     projEmplTransCaller; projEmplTransCaller = formDataSource.getNext())
          #                {
          #                    while select projEmplTransSale
          #                        where projEmplTransSale.TransId == projEmplTransCaller.TransId
          #                    {
          #                        tmpProjProposalId = projEmplTransSale.proposalId();
          #                        if (tmpProjProposalId)
          #                        {
          #                            if (proposalId == SysQuery::valueEmptyString())
          #                            {
          #                                proposalId = tmpProjProposalId;
          #                            }
          #                            else
          #                            {
          #                                proposalId = proposalId+','+tmpProjProposalId;
          #                            }
          #                        }
          #                    }
          #                }
          #                break;
          #
          #            case (tableNum(ProjRevenueTrans)):
          #                projRevenueTransCaller  = element.args().record();
          #                formDataSource          = projRevenueTransCaller.dataSource();
          #                for (projRevenueTransCaller = formDataSource.getFirst(true) ?
          #                     formDataSource.getFirst(true) : formDataSource.cursor();
          #                     projRevenueTransCaller; projRevenueTransCaller = formDataSource.getNext())
          #                {
          #                    while select projRevenueTransSale
          #                        where projRevenueTransSale.TransId == projRevenueTransCaller.TransId
          #                    {
          #                        tmpProjProposalId = projRevenueTransSale.proposalId();
          #                        if (tmpProjProposalId)
          #                        {
          #                            if (proposalId == SysQuery::valueEmptyString())
          #                            {
          #                                proposalId = tmpProjProposalId;
          #                            }
          #                            else
          #                            {
          #                                proposalId = proposalId+','+tmpProjProposalId;
          #                            }
          #                        }
          #                    }
          #                }
          #                break;
          #
          #            case (tableNum(ProjItemTrans)):
          #                projItemTransCaller     = element.args().record();
          #                formDataSource          = projItemTransCaller.dataSource();
          #                for (projItemTransCaller = formDataSource.getFirst(true) ?
          #                     formDataSource.getFirst(true) : formDataSource.cursor();
          #                     projItemTransCaller; projItemTransCaller = formDataSource.getNext())
          #                {
          #                    while select projItemTransSale
          #                        where projItemTransSale.ProjTransId == projItemTransCaller.ProjTransId
          #                    {
          #                        tmpProjProposalId = projItemTransSale.proposalId();
          #                        if (tmpProjProposalId)
          #                        {
          #                            if (proposalId == SysQuery::valueEmptyString())
          #                            {
          #                                proposalId = tmpProjProposalId;
          #                            }
          #                            else
          #                            {
          #                                proposalId = proposalId+','+tmpProjProposalId;
          #                            }
          #                        }
          #                    }
          #                }
          #                break;
          #
          #            case (tableNum(ProjOnAccTrans)):
          #                projOnAccTransCaller    = element.args().record();
          #                formDataSource          = projOnAccTransCaller.dataSource();
          #                for (projOnAccTransCaller = formDataSource.getFirst(true) ?
          #                     formDataSource.getFirst(true) : formDataSource.cursor();
          #                     projOnAccTransCaller; projOnAccTransCaller = formDataSource.getNext())
          #                {
          #                    while select projOnAccTransSale
          #                        where projOnAccTransSale.TransId == projOnAccTransCaller.TransId
          #                    {
          #                        tmpProjProposalId = projOnAccTransSale.proposalId();
          #                        if (tmpProjProposalId)
          #                        {
          #                            if (proposalId == SysQuery::valueEmptyString())
          #                            {
          #                                proposalId = tmpProjProposalId;
          #                            }
          #                            else
          #                            {
          #                                proposalId = proposalId+','+tmpProjProposalId;
          #                            }
          #                        }
          #                    }
          #                }
          #                break;
          #        }
          #
          #        if (!isConfigurationkeyEnabled(configurationKeyNum(Project3)) || proposalId)// Only if the filter value exists set it.
          #        {
          #        criteriaProposalId.value(proposalId);
          #        }
          #    }
          #}
        ENDSOURCE
        SOURCE #editInvoiceFormat
          #edit PSAInvoiceFormat editInvoiceFormat(boolean _set, ProjProposalJour _projProposalJour, PSAInvoiceFormat _newValue)
          #{
          #    PSAInvoiceFormat            currentValue;
          #    PSAInvoiceFormats           formatValue;
          #
          #    if (!isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        return currentValue;
          #    }
          #
          #    select firstonly projProposalRevenuel where projProposalRevenuel.ProposalId == _projProposalJour.ProposalId;
          #
          #    if(_set)
          #    {
          #        if(projProposalRevenuel && projProposalRevenuel.IsRetained)
          #        {
          #            if(_newValue == 0)
          #                formatValue = PSAInvoiceFormats::DetailInvoice;
          #        }
          #        else
          #        {
          #            if(PSAContractLineItems::hasBillingRules(_projProposalJour.ProjInvoiceProjId))
          #            {
          #                switch(_newValue)
          #                {
          #                    case 0:
          #                        formatValue = PSAInvoiceFormats::DetailInvoice;
          #                        break;
          #                    case 1:
          #                        formatValue = PSAInvoiceFormats::ManageInvoice;
          #                        break;
          #                }
          #            }
          #            else
          #            {
          #                switch(_newValue)
          #                {
          #                    case 0:
          #                        formatValue = PSAInvoiceFormats::DetailInvoice;
          #                        break;
          #                    case 1:
          #                        formatValue = PSAInvoiceFormats::SummaryInvoice;
          #                        break;
          #                    case 2:
          #                        formatValue = PSAInvoiceFormats::SummaryByCategory;
          #                        break;
          #                    case 3:
          #                        formatValue = PSAInvoiceFormats::ManageInvoice;
          #                        break;
          #                }
          #            }
          #        }
          #
          #        if(_projProposalJour.psaInvoiceFormats != formatValue)
          #        {
          #            _projProposalJour.psaInvoiceFormats = formatValue;
          #            projProposalJour_ds.refresh();
          #        }
          #    }
          #    if(projProposalRevenuel && projProposalRevenuel.IsRetained)
          #    {
          #        if(_projProposalJour.psaInvoiceFormats == PSAInvoiceFormats::DetailInvoice)
          #            currentValue = 0;
          #    }
          #    else
          #    {
          #        if(PSAContractLineItems::hasBillingRules(_projProposalJour.ProjInvoiceProjId))
          #        {
          #            switch(_projProposalJour.psaInvoiceFormats)
          #            {
          #                case PSAInvoiceFormats::DetailInvoice:
          #                    currentValue = 0;
          #                    break;
          #                case PSAInvoiceFormats::ManageInvoice:
          #                    currentValue = 1;
          #                    break;
          #            }
          #        }
          #        else
          #        {
          #            switch(_projProposalJour.psaInvoiceFormats)
          #            {
          #                case PSAInvoiceFormats::DetailInvoice:
          #                    currentValue = 0;
          #                    break;
          #                case PSAInvoiceFormats::SummaryInvoice:
          #                    currentValue = 1;
          #                    break;
          #                case PSAInvoiceFormats::SummaryByCategory:
          #                    currentValue = 2;
          #                    break;
          #                case PSAInvoiceFormats::ManageInvoice:
          #                    currentValue = 3;
          #                    break;
          #            }
          #        }
          #    }
          #    return currentValue;
          #}
          #
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalEmpl
          Table               #ProjProposalEmpl
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        psaIndirectComponents.enabled(projEmplTrans.psaIndirectComponentGroup ? true : false);
          #    }
          #    if (projProposalEmpl_ds.allowEdit())
          #    {
          #        projProposalEmpl_ds.object(fieldNum(ProjProposalEmpl, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #    }
          #
          #    return ret;
          #}
          #
        ENDSOURCE
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        empl.visible(projProposalEmpl    ? true : false);
          #
          #        projProposalEmpl_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalEmpl && jumpToMain && parmProjTransType == ProjTransType::Hour)
          #        {
          #            projProposalEmpl_ds.findRecord(ProjProposalEmpl::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalEmpl_TransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        empl.visible(false);
          #    }
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalOnAcc
          Table               #ProjProposalOnAcc
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        onAcc.visible(projProposalOnAcc    ? true : false);
          #
          #        projProposalOnAcc_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalOnAcc && jumpToMain && parmProjTransType == ProjTransType::OnAccount)
          #        {
          #           projProposalOnAcc_ds.findRecord(ProjProposalOnAcc::find(parmTransId, projProposalJour.ProposalId));
          #           projProposalOnAcc_TransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        onAcc.visible(false);
          #    }
          #}
        ENDSOURCE
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalOnAcc_ds.allowEdit())
          #    {
          #        projProposalOnAcc_ds.object(fieldNum(ProjProposalOnAcc, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalCost
          Table               #ProjProposalCost
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        cost.visible(projProposalCost    ? true : false);
          #
          #        projProposalCost_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalCost && jumpToMain && parmProjTransType == ProjTransType::Cost)
          #        {
          #            projProposalCost_ds.findRecord(ProjProposalCost::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalCost_TransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        cost.visible(false);
          #    }
          #}
        ENDSOURCE
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalCost_ds.allowEdit())
          #    {
          #        projProposalCost_ds.object(fieldNum(ProjProposalCost, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalItem_SalesOrder
          Table               #ProjProposalItem
          Index               #ProposalIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD DeliverNow
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #void modified()
                #{
                #    super();
                #
                #    projProposalItem_SalesOrder.setQty(DocumentStatus::ProjectInvoice);
                #    projProposalItem_SalesOrder.setInventDeliverNow();
                #    projProposalItem_SalesOrder_ds.forceWrite(true);
                #
                #    if (closeLine.exists(projProposalItem_SalesOrder.RecId))
                #    {
                #        projProposalItem_SalesOrder.RemainAfter = 0;
                #        projProposalItem_SalesOrder.setRemainAfterInvent();
                #    }
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD RemainAfter
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #void modified()
                #{
                #    super();
                #
                #    projProposalItem_SalesOrder.setRemainAfterInvent();
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #write
          #public void write()
          #{
          #    super();
          #
          #    ttsbegin;
          #
          #    projProposalItem_SalesOrder.setLineAmount();
          #
          #    ttscommit;
          #}
        ENDSOURCE
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    projProposalItem_SalesOrder_ds.object(fieldNum(ProjProposalItem, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #
          #    return ret;
          #}
        ENDSOURCE
        SOURCE #closeLine
          #// BP Deviation documented
          #edit NoYes closeLine(boolean            _set,
          #                     ProjProposalItem   _projProposalItem,
          #                     NoYes              _closeLine)
          #{
          #    if (_set)
          #    {
          #        if (_closeLine)
          #        {
          #            _projProposalItem.RemainAfter = 0;
          #            _projProposalItem.setRemainAfterInvent();
          #            closeLine.insert(_projProposalItem.RecId,1);
          #        }
          #        else
          #        {
          #            _projProposalItem.setQty(DocumentStatus::ProjectInvoice);
          #            _projProposalItem.setInventDeliverNow();
          #            closeLine.insert(_projProposalItem.RecId,0);
          #        }
          #    }
          #
          #    if (! closeLine.exists(_projProposalItem.RecId))
          #    {
          #        closeLine.insert(_projProposalItem.RecId,0);
          #    }
          #
          #    return closeLine.lookup(_projProposalItem.RecId);
          #}
        ENDSOURCE
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        item_SalesLine.visible(projProposalItem_SalesOrder    ? true : false);
          #
          #        projProposalItem_SalesOrder_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalItem_SalesOrder && jumpToMain && parmProjTransType == ProjTransType::Item && parmIsItemTransTypeSales)
          #        {
          #            projProposalItem_SalesOrder_ds.findRecord(ProjProposalItem::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalItem_SalesOrder_ProjTransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        item_SalesLine.visible(false);
          #    }
          #}
          #
          #
        ENDSOURCE
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::SalesOrder));
          #}
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalRevenue
          Table               #ProjProposalRevenue
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        revenue.visible(projProposalRevenue ? true : false);
          #
          #        projProposalRevenue_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalRevenue && jumpToMain && parmProjTransType == ProjTransType::Revenue && !parmIsRevTransOriginSubscription)
          #        {
          #            projProposalRevenue_ds.findRecord(ProjProposalRevenue::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalRevenue_TransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        revenue.visible(false);
          #    }
          #
          #}
        ENDSOURCE
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalRevenue_ds.allowEdit())
          #    {
          #        projProposalRevenue_ds.object(fieldNum(ProjProposalRevenue, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        this.query().dataSourceTable(tableNum(ProjProposalRevenue)).addRange(fieldNum(ProjProposalRevenue, IsRetained)).value(SysQuery::valueNot(NoYes::Yes));
          #    }
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #projEmplTrans
          Table               #ProjEmplTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalEmpl
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #projCostTrans
          Table               #ProjCostTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalCost
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #projOnAccTrans
          Table               #ProjOnAccTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalOnAcc
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjRevenueTrans
          Table               #ProjRevenueTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalRevenue
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    this.query().dataSourceTable(tableNum(ProjRevenueTrans)).addRange(fieldNum(ProjRevenueTrans, TransactionOrigin)).value(SysQuery::valueNot(ProjOrigin::Subscription));
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjItemTrans_Project
          Table               #ProjItemTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalItem_Project
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalItem_Project
          Table               #ProjProposalItem
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::Project));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::InventJournal));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::PurchOrder));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::VendorInvoice));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::Production));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::ProdLine));
          #    this.query().dataSourceTable(tableNum(ProjProposalItem),1).addRange(fieldNum(ProjProposalItem,ItemType)).value(queryValue(ProjItemType::BeginningBalance));
          #}
          #
        ENDSOURCE
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        item_Project.visible(projProposalItem_Project    ? true : false);
          #
          #        projProposalItem_Project_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalItem_Project && jumpToMain && parmProjTransType == ProjTransType::Item && !parmIsItemTransTypeSales)
          #        {
          #            projProposalItem_Project_ds.findRecord(ProjProposalItem::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalItem_Project_ProjTransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        item_Project.visible(false);
          #    }
          #}
          #
        ENDSOURCE
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalItem_Project_ds.allowEdit())
          #    {
          #        projProposalItem_Project_ds.object(fieldNum(ProjProposalItem, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #SalesLine
          Table               #SalesLine
          Index               #SalesLineIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalItem_SalesOrder
          LinkType            #InnerJoin
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    if (!isConfigurationkeyEnabled(new DictTable(tableNum(SalesLine)).configurationKeyId()))
          #    {
          #        salesLine_ds.linkType(FormLinkType::Passive);
          #    }
          #}
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalRevenueSubscription
          Table               #ProjProposalRevenue
          Index               #ProposalIdx
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    projProposalRevenueSubscription_ds.object(fieldNum(ProjProposalRevenue, eInvoiceAccountCode)).enabled(projProposalJour.eInvoiceLineSpecific);
          #
          #    return ret;
          #}
        ENDSOURCE
        SOURCE #linkActive
          #public void linkActive()
          #{
          #    super();
          #    if (projProposalJour_ds.recordsMarked().lastIndex() <= 1)
          #    {
          #        revenueSubscription.visible(projProposalRevenueSubscription ? true : false);
          #
          #        projProposalRevenueSubscription_EInvoiceAccountCode.visible(CustTable::isCustDKPublic(projProposalJour.InvoiceAccount));
          #
          #        if (projProposalRevenueSubscription && jumpToMain && parmProjTransType == ProjTransType::Revenue && parmIsRevTransOriginSubscription)
          #        {
          #            projProposalRevenueSubscription_ds.findRecord(ProjProposalRevenue::find(parmTransId, projProposalJour.ProposalId));
          #            projProposalRevenueSubscription_TransId.setFocus();
          #        }
          #    }
          #    else
          #    {
          #        revenueSubscription.visible(false);
          #    }
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjRevenueTransSubscription
          Table               #ProjRevenueTrans
          Index               #TransIdx
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalRevenueSubscription
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    this.query().dataSourceTable(tableNum(ProjRevenueTrans), 1).addRange(fieldNum(ProjRevenueTrans, TransactionOrigin)).value(queryValue(ProjOrigin::Subscription));
          #
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalEmplDetail
          Table               #ProjProposalEmplDetail
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalEmpl
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD SalesPrice
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #
                #    projProposalEmplDetail.AmountCur = Currency::amount(projProposalEmpl.qty() * projProposalEmplDetail.SalesPrice, projProposalJour.CurrencyId);
                #
                #    // <GBR>
                #    if (BrazilParameters::isEnabled() && projProposalEmpl.IncludedTaxPercent_BR)
                #    {
                #        projProposalEmplDetail.AmountCur = Currency::amount(projProposalEmpl.qty() * projProposalEmplDetail.salesPriceInclTax_BR(projProposalEmpl.IncludedTaxPercent_BR), projProposalJour.CurrencyId);
                #    }
                #    // </GBR>
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalEmplDetail_ds.allowEdit())
          #    {
          #        if (projProposalEmplDetail.projEmplTransSale().TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalEmplDetail_ds.object(fieldNum(ProjProposalEmplDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            projProposalEmplDetail_ds.object(fieldNum(ProjProposalEmplDetail, AmountCur)).allowEdit(true);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalCostDetail
          Table               #ProjProposalCostDetail
          AllowCheck          #No
          AllowCreate         #No
          JoinSource          #ProjProposalCost
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD SalesPrice
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #
                #    projProposalCostDetail.AmountCur = Currency::amount(projProposalCost.qty() * projProposalCostDetail.SalesPrice, projProposalJour.CurrencyId);
                #
                #    // <GBR>
                #    if (BrazilParameters::isEnabled() && projProposalCost.IncludedTaxPercent_BR)
                #    {
                #        projProposalCostDetail.AmountCur = Currency::amount(projProposalCost.qty() * projProposalCostDetail.salesPriceInclTax_BR(projProposalCost.IncludedTaxPercent_BR), projProposalJour.CurrencyId);
                #    }
                #    // </GBR>
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalCostDetail_ds.allowEdit())
          #    {
          #        if (projProposalCostDetail.projCostTransSale().TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalCostDetail_ds.object(fieldNum(ProjProposalCostDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            projProposalCostDetail_ds.object(fieldNum(ProjProposalCostDetail, AmountCur)).allowEdit(true);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalItemDetail_Project
          Table               #ProjProposalItemDetail
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalItem_Project
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD SalesPrice
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #
                #    projProposalItemDetail_Project.AmountCur =  PriceDisc::price2Amount(projProposalItemDetail_Project.SalesPrice,
                #                                                InventTable::find(projProposalItem_Project.ItemId).salesPriceUnit(),
                #                                                0,
                #                                                projProposalItem_Project.qty(),
                #                                                0,
                #                                                0,
                #                                                0,
                #                                                projProposalJour.CurrencyId,
                #                                                0,
                #                                                false);
                #
                #    // <GBR>
                #    if (BrazilParameters::isEnabled() && projProposalItem_Project.IncludedTaxPercent_BR)
                #    {
                #        projProposalItemDetail_Project.AmountCur =  PriceDisc::price2Amount(projProposalItemDetail_Project.salesPriceInclTax_BR(projProposalItem_Project.IncludedTaxPercent_BR),
                #                                                    InventTable::find(projProposalItem_Project.ItemId).salesPriceUnit(),
                #                                                    0,
                #                                                    projProposalItem_Project.qty(),
                #                                                    0,
                #                                                    0,
                #                                                    0,
                #                                                    projProposalJour.CurrencyId,
                #                                                    0,
                #                                                    false);
                #    }
                #    // </GBR>
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalItemDetail_Project_ds.allowEdit())
          #    {
          #        if (projProposalItemDetail_Project.projItemTransSale().TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalItemDetail_Project_ds.object(fieldNum(ProjProposalItemDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            projProposalItemDetail_Project_ds.object(fieldNum(ProjProposalItemDetail, AmountCur)).allowEdit(true);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalRevenueDetail
          Table               #ProjProposalRevenueDetail
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalRevenue
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalRevenueDetail_ds.allowEdit())
          #    {
          #        if (projProposalRevenueDetail.projRevenueTransSale().TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalRevenueDetail_ds.object(fieldNum(ProjProposalRevenueDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            projProposalRevenueDetail_ds.object(fieldNum(ProjProposalRevenueDetail, AmountCur)).allowEdit(true);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalOnAccDetail
          Table               #ProjProposalOnAccDetail
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalOnAcc
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (projProposalOnAccDetail_ds.allowEdit())
          #    {
          #        if (projProposalOnAccDetail.projOnAccTransSale().TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalOnAccDetail_ds.object(fieldNum(ProjProposalOnAccDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            projProposalOnAccDetail_ds.object(fieldNum(ProjProposalOnAccDetail, AmountCur)).allowEdit(true);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalRevenueDetailSubscription
          Table               #ProjProposalRevenueDetail
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalRevenueSubscription
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int                     ret;
          #    boolean                 isEditable = false;
          #    ProjRevenueTransSale    localProjRevenueTransSale;
          #    ProjRevenueTrans        localProjRevenueTrans;
          #
          #    ret = super();
          #
          #    if (projProposalRevenueDetailSubscription_ds.allowEdit())
          #    {
          #        localProjRevenueTransSale = projProposalRevenueDetailSubscription.projRevenueTransSale();
          #        if (localProjRevenueTransSale.TransStatus == ProjTransStatus::CreditnoteProposal)
          #        {
          #            projProposalRevenueDetailSubscription_ds.object(fieldNum(ProjProposalRevenueDetail, AmountCur)).allowEdit(false);
          #        }
          #        else
          #        {
          #            localProjRevenueTrans = localProjRevenueTransSale.projRevenueTrans();
          #
          #            // Edit SalesPrice if either Index or BasePrice is empty
          #            if (localProjRevenueTrans.smaIndex == 0.00 ||
          #                localProjRevenueTrans.smaBasePrice == 0.00)
          #            {
          #                isEditable = true;
          #            }
          #            projProposalRevenueDetailSubscription_ds.object(fieldNum(ProjProposalRevenueDetail, AmountCur)).allowEdit(isEditable);
          #        }
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalItemDetail_SalesOrder
          Table               #ProjProposalItemDetail
          AllowCheck          #No
          AllowEdit           #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalItem_SalesOrder
          LinkType            #InnerJoin
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #PSAProjProposalProj
          Table               #PSAProjProposalProj
          AllowCheck          #No
          AllowCreate         #No
          AllowDelete         #No
          JoinSource          #ProjProposalJour
          LinkType            #Active
          InsertAtEnd         #No
          InsertIfEmpty       #No
        ENDPROPERTIES
        
        FIELDLIST
          DATAFIELD ContractLineNum
            PROPERTIES
              AllowEdit           #No
            ENDPROPERTIES
            
            METHODS
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD Invoiced
            PROPERTIES
              AllowEdit           #No
            ENDPROPERTIES
            
            METHODS
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD InvoicedNow
            PROPERTIES
              AllowEdit           #No
            ENDPROPERTIES
            
            METHODS
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD ProjId
            PROPERTIES
              AllowEdit           #No
            ENDPROPERTIES
            
            METHODS
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD RetainedNow
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #    psaProjProposalProj_ds.research();
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
          DATAFIELD RetainedPercent
            PROPERTIES
            ENDPROPERTIES
            
            METHODS
              SOURCE #modified
                #public void modified()
                #{
                #    super();
                #    psaProjProposalProj_ds.research();
                #}
              ENDSOURCE
            ENDMETHODS
          ENDDATAFIELD
          
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #active
          #public int active()
          #{
          #    int ret;
          #
          #    ret = super();
          #
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        psaProjProposalProj_RetainedPercent.allowEdit(!(psaProjProposalProj.IsPreBill || (projProposalJour.InvoiceAmount < 0 ? true : false)));
          #        psaProjProposalProj_RetainedNow.allowEdit(!(psaProjProposalProj.IsPreBill || (projProposalJour.InvoiceAmount < 0 ? true : false)));
          #    }
          #
          #    return ret;
          #}
        ENDSOURCE
        SOURCE #init
          #public void init()
          #{
          #    super();
          #
          #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
          #    {
          #        this.query().dataSourceTable(tableNum(PSAProjProposalProj)).addSortField(fieldNum(PSAProjProposalProj, IsPreBill), SortOrder::Ascending);
          #    }
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #TaxServiceTariffProjProposalEmpl
          Table               #TaxServiceTariff
          OnlyFetchActive     #Yes
          JoinSource          #ProjProposalEmpl
          LinkType            #OuterJoin
          InsertAtEnd         #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #write
          #// <GEEPL>
          #public void write()
          #{
          #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoPL]) && (!taxServiceTariffProjProposalEmpl.ParentRecId || taxServiceTariffProjProposalEmpl.ParentTableId))
          #    {
          #        // Write can cause the child data source to lose it's foreign key values so restore them.
          #        taxServiceTariffProjProposalEmpl.ParentRecId = projProposalEmpl.RecId;
          #        taxServiceTariffProjProposalEmpl.ParentTableId = projProposalEmpl.TableId;
          #        taxServiceTariffProjProposalEmpl_ds.refresh();
          #    }
          #
          #    super();
          #}
          #// </GEEPL>
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #TaxServiceTariffProjProposalItem
          Table               #TaxServiceTariff
          OnlyFetchActive     #Yes
          JoinSource          #ProjItemTrans_Project
          LinkType            #OuterJoin
          InsertAtEnd         #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #write
          #// <GEEPL>
          #public void write()
          #{
          #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoPL]) && (!taxServiceTariffProjProposalItem.ParentRecId || !taxServiceTariffProjProposalItem.ParentTableId))
          #    {
          #        // Write can cause the child data source to lose it's foreign key values so restore them.
          #        taxServiceTariffProjProposalItem.ParentRecId = projItemTrans_Project.RecId;
          #        taxServiceTariffProjProposalItem.ParentTableId = projItemTrans_Project.TableId;
          #        taxServiceTariffProjProposalItem_ds.refresh();
          #    }
          #
          #    super();
          #}
          #// </GEEPL>
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #TaxServiceTariffProjProposalOnAcc
          Table               #TaxServiceTariff
          OnlyFetchActive     #Yes
          JoinSource          #ProjProposalOnAcc
          LinkType            #OuterJoin
          InsertAtEnd         #No
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #write
          #// <GEEPL>
          #public void write()
          #{
          #    if (SysCountryRegionCode::isLegalEntityInCountryRegion([#isoPL]) && (!taxServiceTariffProjProposalOnAcc.ParentRecId || !taxServiceTariffProjProposalOnAcc.ParentTableId))
          #    {
          #        // Write can cause the child data source to lose it's foreign key values so restore them.
          #        taxServiceTariffProjProposalOnAcc.ParentRecId = projProposalOnAcc.RecId;
          #        taxServiceTariffProjProposalOnAcc.ParentTableId = projProposalOnAcc.TableId;
          #        taxServiceTariffProjProposalOnAcc_ds.refresh();
          #    }
          #
          #    super();
          #}
          #// </GEEPL>
          #
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
    DATASOURCE
      OBJECTPOOL
        PROPERTIES
          Name                #ProjProposalJourExtensionCN
          Table               #ProjProposalJourExtensionCN
          JoinSource          #ProjProposalJour
          LinkType            #Passive
        ENDPROPERTIES
        
        FIELDLIST
        ENDFIELDLIST
      ENDOBJECTPOOL
      METHODS
        SOURCE #init
          #public void init()
          #{
          #    if (CustParameters::isTaxIntegrationSystem_CN())
          #    {
          #        projProposalJourExtensionCN_ds.linkType(FormLinkType::OuterJoin);
          #    }
          #
          #    super();
          #
          #
          #}
        ENDSOURCE
      ENDMETHODS
    ENDDATASOURCE
  ENDOBJECTBANK
  
  REFERENCEDATASOURCES
  ENDREFERENCEDATASOURCES
  
  JOINS
    ProjProposalEmpl ProjProposalJour
    ProjProposalOnAcc ProjProposalJour
    ProjProposalCost ProjProposalJour
    ProjProposalItem_SalesOrder ProjProposalJour
    ProjProposalRevenue ProjProposalJour
    projEmplTrans ProjProposalEmpl
    projCostTrans ProjProposalCost
    projOnAccTrans ProjProposalOnAcc
    ProjRevenueTrans ProjProposalRevenue
    ProjItemTrans_Project ProjProposalItem_Project
    ProjProposalItem_Project ProjProposalJour
    SalesLine ProjProposalItem_SalesOrder
    ProjProposalRevenueSubscription ProjProposalJour
    ProjRevenueTransSubscription ProjProposalRevenueSubscription
    ProjProposalEmplDetail ProjProposalEmpl
    ProjProposalCostDetail ProjProposalCost
    ProjProposalItemDetail_Project ProjProposalItem_Project
    ProjProposalRevenueDetail ProjProposalRevenue
    ProjProposalOnAccDetail ProjProposalOnAcc
    ProjProposalRevenueDetailSubscription ProjProposalRevenueSubscription
    ProjProposalItemDetail_SalesOrder ProjProposalItem_SalesOrder
    PSAProjProposalProj ProjProposalJour
    TaxServiceTariffProjProposalEmpl ProjProposalEmpl
    TaxServiceTariffProjProposalItem ProjItemTrans_Project
    TaxServiceTariffProjProposalOnAcc ProjProposalOnAcc
    ProjProposalJourExtensionCN ProjProposalJour
  ENDJOINS
  
  PARTREFERENCES
  ENDPARTREFERENCES
  
  DESIGN
    PROPERTIES
      Caption             #@SYS336293
      TitleDatasource     #ProjProposalJour
      DataSource          #ProjProposalJour
      ArrangeWhen         #Auto
      HideIfEmpty         #No
      WorkflowEnabled     #Yes
      WorkflowDatasource  #ProjProposalJour
      Style               #SimpleList
    ENDPROPERTIES
    
    CONTAINER
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #ActionPane
          ElementPosition     #536870911
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #CostActionStrip
          ElementPosition     #954437176
          HierarchyParent     #Cost
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #EmplActionStrip
          ElementPosition     #954437176
          HierarchyParent     #Empl
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #ItemActionStrip
          ElementPosition     #1073741822
          HierarchyParent     #Item_Project
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #OnAccActionStrip
          ElementPosition     #954437176
          HierarchyParent     #OnAcc
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #RevenueActionStrip
          ElementPosition     #954437176
          HierarchyParent     #Revenue
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #SalesLineActionStrip
          ElementPosition     #1073741822
          HierarchyParent     #Item_SalesLine
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANE
        PROPERTIES
          Name                #SubscriptionActionStrip
          ElementPosition     #954437176
          HierarchyParent     #RevenueSubscription
          Style               #Strip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #ActionPaneTab
          ElementPosition     #1431655764
          HierarchyParent     #ActionPane
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #CostActionTab
          ElementPosition     #1431655764
          HierarchyParent     #CostActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #EmplActionTab
          ElementPosition     #1431655764
          HierarchyParent     #EmplActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #ItemActionTab
          ElementPosition     #1431655764
          HierarchyParent     #ItemActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #OnAccActionTab
          ElementPosition     #1431655764
          HierarchyParent     #OnAccActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #RevenueActionTab
          ElementPosition     #1431655764
          HierarchyParent     #RevenueActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #SalesLineActionTab
          ElementPosition     #1431655764
          HierarchyParent     #SalesLineActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL ACTIONPANETAB
        PROPERTIES
          Name                #SubscriptionActionTab
          ElementPosition     #1431655764
          HierarchyParent     #SubscriptionActionStrip
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #ButtonGroup
          ElementPosition     #1073741822
          HierarchyParent     #ActionPaneTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #ButtonGroup3
          ElementPosition     #1610612734
          HierarchyParent     #ActionPaneTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup
          ElementPosition     #1431655764
          HierarchyParent     #EmplActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup1
          ElementPosition     #1431655764
          HierarchyParent     #ItemActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup3
          ElementPosition     #1431655764
          HierarchyParent     #RevenueActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup4
          ElementPosition     #1431655764
          HierarchyParent     #CostActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup5
          ElementPosition     #1431655764
          HierarchyParent     #SubscriptionActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup6
          ElementPosition     #1431655764
          HierarchyParent     #OnAccActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTONGROUP
        PROPERTIES
          Name                #RemoveButtonGroup7
          ElementPosition     #1431655764
          HierarchyParent     #SalesLineActionTab
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #CostGrid
          Width               #Column width
          Height              #Column height
          ElementPosition     #1550960411
          HierarchyParent     #Cost
          VisibleCols         #7
          VisibleRows         #5
          DataSource          #ProjProposalCost
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #EmplGrid
          Width               #Column width
          Height              #Column height
          ElementPosition     #1550960411
          HierarchyParent     #Empl
          VisibleCols         #8
          VisibleRows         #5
          DataSource          #ProjProposalEmpl
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #Item_SalesLineGrid
          Width               #Column width
          Height              #110
          ElementPosition     #1431655764
          HierarchyParent     #Item_SalesLine
          VisibleCols         #3
          VisibleRows         #5
          DataSource          #ProjProposalItem_SalesOrder
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #ItemProjectGrid
          Width               #Column width
          Height              #Column height
          ElementPosition     #1610612734
          HierarchyParent     #Item_Project
          VisibleCols         #7
          VisibleRows         #5
          DataSource          #ProjProposalItem_Project
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #OnAccGrid
          Width               #Column width
          Height              #110
          ElementPosition     #1431655764
          HierarchyParent     #OnAcc
          VisibleCols         #5
          VisibleRows         #5
          DataSource          #ProjProposalOnAcc
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #PrijInvoiceProposalGrid
          AutoDeclaration     #Yes
          Width               #Column width
          Height              #Column height
          ElementPosition     #1073741822
          HierarchyParent     #TabProjProposalJour
          VisibleRows         #5
          DataSource          #ProjProposalJour
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #RevenueGrid
          Width               #Column width
          Height              #110
          ElementPosition     #1431655764
          HierarchyParent     #Revenue
          VisibleCols         #5
          VisibleRows         #5
          DataSource          #ProjProposalRevenue
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #Subscriptiongrid
          Width               #Column width
          Height              #110
          ElementPosition     #1431655764
          HierarchyParent     #RevenueSubscription
          VisibleCols         #9
          VisibleRows         #5
          DataSource          #ProjProposalRevenueSubscription
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GRID
        PROPERTIES
          Name                #SummaryGrid
          Width               #Column width
          Height              #Column height
          ElementPosition     #1431655764
          HierarchyParent     #CtrlSummary
          VisibleRows         #10
          DataSource          #PSAProjProposalProj
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #CtrlHeader
          AutoDeclaration     #Yes
          Width               #Column width
          Height              #Column height
          ElementPosition     #1610612733
          FrameType           #None
          Style               #DetailTitleContainer
          AlignChild          #No
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #CtrlSummary
          Width               #Column width
          Height              #Column height
          ConfigurationKey    #Project3
          ElementPosition     #1610612734
          HierarchyParent     #TabProjProposalJour
          FrameType           #None
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #HeadVAT
          AutoDeclaration     #Yes
          CountryRegionCodes  #CN
          ElementPosition     #1879048190
          HierarchyParent     #TabProjProposalJour
          Caption             #@GLS221099
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #OptionGroup
          ElementPosition     #1073741822
          FrameType           #None
          Style               #BorderlessGridContainer
          TopMargin           #10
          LeftMargin          #10
          RightMargin         #10
          Columns             #4
          ArrangeGuide        
            ARRAY INDEX Columns 
              #0
              #0
              #0
              #0
            ENDARRAY
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #Reason
          CountryRegionCodes  #CZ,EE,HU,PL,LT,LV
          ElementPosition     #1452709520
          HierarchyParent     #PrijInvoiceProposalGrid
          BackgroundColor     #Window background
          DataSource          #ProjProposalJour
          DataGroup           #Reason
          ViewEditMode        #Edit
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL GROUP
        PROPERTIES
          Name                #SplitInfo_BR
          CountryRegionCodes  #BR
          ElementPosition     #2106185881
          HierarchyParent     #PrijInvoiceProposalGrid
          BackgroundColor     #Window background
          DataSource          #ProjProposalJour
          DataGroup           #SplitInfo_BR
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUBUTTON
        PROPERTIES
          Name                #CtrlCourse
          AutoDeclaration     #Yes
          Enabled             #No
          HelpText            #@SYS76307
          ElementPosition     #1342177276
          HierarchyParent     #ButtonGroup3
          Text                #@SYS16449
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUBUTTON
        PROPERTIES
          Name                #New
          HelpText            #@SYS339985
          ElementPosition     #1073741822
          HierarchyParent     #ButtonGroup
          Text                #@SYS2055
          ButtonDisplay       #Text & Image left
          NormalImage         #11045
          ImageLocation       #EmbeddedResource
          Primary             #Yes
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #CustInvoiceTableExtensionCN_VATInvoiceDesc
          ElementPosition     #858993458
          HierarchyParent     #HeadVAT
          DataSource          #ProjProposalJourExtensionCN
          ReferenceField      #VATInvoiceDescTable
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #FundingSource
          AllowEdit           #No
          ConfigurationKey    #ProjAdvFunding
          ElementPosition     #505290268
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          ReferenceField      #FundingSource
          ReplacementFieldGroup #FundingSourceName
          Label               #@SYS120466
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #projCostTrans_Worker
          ElementPosition     #920350134
          HierarchyParent     #CostGrid
          DataSource          #projCostTrans
          ReferenceField      #Worker
          Label               #@SYS89158
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #projCostTrans_WorkerAffiliation
          Visible             #No
          ElementPosition     #1073741823
          HierarchyParent     #CostGrid
          DataSource          #projCostTrans
          ReferenceField      #WorkerLegalEntity
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #projEmplTrans_Worker
          ElementPosition     #858993456
          HierarchyParent     #EmplGrid
          DataSource          #projEmplTrans
          ReferenceField      #Worker
          Label               #@SYS89158
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #ProjRevenueTrans_Worker
          ElementPosition     #1073741820
          HierarchyParent     #RevenueGrid
          DataSource          #ProjRevenueTrans
          ReferenceField      #Worker
          Label               #@SYS89158
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #ServiceTariffNumberProjProposalEmpl
          HelpText            #@GLS115894
          ElementPosition     #2064888117
          HierarchyParent     #EmplGrid
          DataSource          #TaxServiceTariffProjProposalEmpl
          ReferenceField      #ServiceTariffNumber
          ReplacementFieldGroup #ServiceTariffId
          Label               #@GLS115893
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #ServiceTariffNumberProjProposalItem
          HelpText            #@GLS115894
          ElementPosition     #2064888117
          HierarchyParent     #ItemProjectGrid
          DataSource          #TaxServiceTariffProjProposalItem
          ReferenceField      #ServiceTariffNumber
          ReplacementFieldGroup #ServiceTariffId
          Label               #@GLS115893
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #ServiceTariffNumberProjProposalOnAcc
          HelpText            #@GLS115894
          ElementPosition     #2013265915
          HierarchyParent     #OnAccGrid
          DataSource          #TaxServiceTariffProjProposalOnAcc
          ReferenceField      #ServiceTariffNumber
          ReplacementFieldGroup #ServiceTariffId
          Label               #@GLS115893
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REFERENCEGROUP
        PROPERTIES
          Name                #SplitInfo_BR_FiscalDocumentType_BR
          ElementPosition     #1288490187
          HierarchyParent     #SplitInfo_BR
          DataSource          #ProjProposalJour
          ReferenceField      #FiscalDocumentType_BR
          ReplacementFieldGroup #FiscalDocumentType
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TAB
        PROPERTIES
          Name                #Heading
          AutoDeclaration     #Yes
          Width               #Column width
          Height              #Column height
          ElementPosition     #1431655764
          HierarchyParent     #CtrlHeader
          Tabs                #8
        ENDPROPERTIES
        
        METHODS
          SOURCE #tabChanged
            #public void tabChanged(int _fromTab, int _toTab)
            #{
            #    super(_fromTab, _toTab);
            #
            #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
            #    {
            #        psaIndirectComponents.enabled(projEmplTrans.psaIndirectComponentGroup ? true : false);
            #    }
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #Cost
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #858993456
          HierarchyParent     #Heading
          Caption             #@SYP4882014
          DataSource          #ProjProposalCost
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #Empl
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #644245092
          HierarchyParent     #Heading
          Caption             #@SYS5269
          DataSource          #ProjProposalEmpl
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #Item_Project
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #1073741820
          HierarchyParent     #Heading
          Caption             #@SYS7407
          DataSource          #ProjProposalItem_Project
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #Item_SalesLine
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #1932735276
          HierarchyParent     #Heading
          Caption             #@SYS58747
          DataSource          #ProjProposalItem_SalesOrder
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #OnAcc
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #1717986912
          HierarchyParent     #Heading
          Caption             #@SYS50040
          DataSource          #ProjProposalOnAcc
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #Revenue
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #1288490184
          HierarchyParent     #Heading
          Caption             #@SYS9154
          DataSource          #ProjProposalRevenue
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #RevenueSubscription
          AutoDeclaration     #Yes
          Visible             #No
          Width               #Column width
          Height              #Column height
          ElementPosition     #1503238548
          HierarchyParent     #Heading
          Caption             #@SYS14482
          DataSource          #ProjProposalRevenueSubscription
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL TABPAGE
        PROPERTIES
          Name                #TabProjProposalJour
          AutoDeclaration     #Yes
          Width               #Column width
          Height              #Column height
          ElementPosition     #429496728
          HierarchyParent     #Heading
          Caption             #@SYS9039
          DataSource          #ProjProposalJour
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTON
        PROPERTIES
          Name                #BtnDisplay
          AutoDeclaration     #Yes
          HelpText            #@SYS116632
          ConfigurationKey    #Project3
          ElementPosition     #1533916890
          HierarchyParent     #OptionGroup
          Text                #@SYS116636
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    criteriaInvoiceProjId.value(selectProjInvoiceProjId.valueStr());
            #
            #    projProposalJour_ds.executeQuery();
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL BUTTON
        PROPERTIES
          Name                #CtrlCancel
          AutoDeclaration     #Yes
          Enabled             #No
          HelpText            #@SYS50085
          ElementPosition     #1610612733
          HierarchyParent     #ButtonGroup
          Text                #@SYS14425
          ButtonDisplay       #Text & Image left
          NormalImage         #10121
          ImageLocation       #EmbeddedResource
          MultiSelect         #Yes
          Primary             #Yes
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    Args               args = new Args();
            #
            #    if (!projProposalJour.ProposalId)
            #    {
            #        return;
            #    }
            #
            #    super();
            #
            #    args.caller(this);
            #    args.record(projProposalJour);
            #    ProjInvoiceCancel::main(args);
            #
            #    projProposalJour_ds.research();
            #    element.setButtonAccess();
            #
            #    element.updateRelatedForm();
            #
            #    tabProjProposalJour.setFocus();
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL CHECKBOX
        PROPERTIES
          Name                #CloseLine
          HelpText            #@SYS26414
          ElementPosition     #1431655760
          HierarchyParent     #Item_SalesLineGrid
          BackgroundColor     #Window background
          Label               #@SYS18742
          DataSource          #ProjProposalItem_SalesOrder
          DataMethod          #CloseLine
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL CHECKBOX
        PROPERTIES
          Name                #ProjProposalJour_EInvoiceLineSpecific
          AutoDeclaration     #Yes
          AllowEdit           #No
          ElementPosition     #1515870804
          HierarchyParent     #PrijInvoiceProposalGrid
          BackgroundColor     #Window background
          DataSource          #ProjProposalJour
          DataField           #EInvoiceLineSpecific
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL CHECKBOX
        PROPERTIES
          Name                #ProjProposalJour_InvoiceAutoNumbering_LT
          ElementPosition     #2064888117
          HierarchyParent     #PrijInvoiceProposalGrid
          BackgroundColor     #Window background
          DataSource          #ProjProposalJour
          DataField           #InvoiceAutoNumbering_LT
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL CHECKBOX
        PROPERTIES
          Name                #PSASubmitted
          AutoDeclaration     #Yes
          Visible             #No
          HelpText            #@PSA1041
          ConfigurationKey    #Project3
          ElementPosition     #1840700268
          HierarchyParent     #OptionGroup
          Label               #@SYS302263
        ENDPROPERTIES
        
        METHODS
          SOURCE #modified
            #public boolean modified()
            #{
            #    boolean     ret;
            #
            #    ret = super();
            #
            #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)) && ret)
            #    {
            #        element.lock();
            #
            #        projProposalJour_ds.executeQuery();
            #        projProposalJour_ds.refresh();
            #
            #        element.unLock();
            #    }
            #
            #
            #    return ret;
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMBOBOX
        PROPERTIES
          Name                #CtrlActiveAll
          AutoDeclaration     #Yes
          HelpText            #@SYS91911
          ElementPosition     #613566756
          HierarchyParent     #OptionGroup
          Label               #@SYS53481
          EnumType            #PSAInvoiceProposalStatus
        ENDPROPERTIES
        
        METHODS
          SOURCE #modified
            #public boolean modified()
            #{
            #    boolean     ret;
            #
            #    ret = super();
            #
            #    if (ret)
            #    {
            #        element.lock();
            #
            #        projProposalJour_ds.executeQuery();
            #        projProposalJour_ds.refresh();
            #
            #        element.unLock();
            #    }
            #
            #    return ret;
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMBOBOX
        PROPERTIES
          Name                #ProjectInvoiceProposaleJour_InvoiceStatus
          ElementPosition     #1389548237
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #LineProperty
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMBOBOX
        PROPERTIES
          Name                #ProjectInvoiceProposaleJour_InvoiceType
          AutoDeclaration     #Yes
          ElementPosition     #884257969
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #InvoiceType
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMBOBOX
        PROPERTIES
          Name                #ProjProposalJour_InvoiceFormats
          AutoDeclaration     #Yes
          ConfigurationKey    #Project3
          ElementPosition     #1810623462
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataMethod          #editInvoiceFormat
        ENDPROPERTIES
        
        METHODS
          SOURCE #enter
            #public void enter()
            #{
            #    super();
            #
            #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
            #    {
            #        element.fillInvoiceFormatCombo();
            #    }
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMBOBOX
        PROPERTIES
          Name                #ProjProposalJour_PSAInvoiceMethod
          Visible             #No
          ConfigurationKey    #Project3
          ElementPosition     #757935402
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #PSAInvoiceMethod
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonCostRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup4
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonEmplRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonItemRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup1
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonOnAccRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup6
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonRevenueRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup3
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonSalesLineRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup7
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #buttonSubscriptionRemove
          HelpText            #@SYS328874
          ElementPosition     #1431655764
          HierarchyParent     #RemoveButtonGroup5
          Text                #@SYS135131
          ButtonDisplay       #Text & Image left
          NormalImage         #11400
          ImageLocation       #EmbeddedResource
          ShowShortCut        #No
          SaveRecord          #No
          MultiSelect         #Yes
          Primary             #Yes
          NeedsRecord         #Yes
          Command             #2832
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #CtrlApprove
          AutoDeclaration     #Yes
          HelpText            #@SYS16449
          ElementPosition     #1073741822
          HierarchyParent     #CtrlCourse
          Text                #@SYS16449
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    super();
            #
            #    projProposalJour.approveProposale();
            #
            #    projProposalJour_ds.research();
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL COMMANDBUTTON
        PROPERTIES
          Name                #CtrlCancelApprove
          AutoDeclaration     #Yes
          HelpText            #@SYS50162
          ElementPosition     #1610612733
          HierarchyParent     #CtrlCourse
          Text                #@SYS50162
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    super();
            #
            #    projProposalJour.cancelApprovel();
            #
            #    projProposalJour_ds.research();
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #ProjectInvoiceProposalJour_InvoiceDate
          AllowEdit           #No
          ElementPosition     #1136903103
          HierarchyParent     #PrijInvoiceProposalGrid
          Label               #@SYS57610
          DataSource          #ProjProposalJour
          DataField           #InvoiceDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #ProjItemProject_TransDate
          ElementPosition     #330382098
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjItemTrans_Project
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #ProjRevenueTransSubscription_SMAEnddate
          ElementPosition     #1380525201
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #SMAEnddate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #ProjRevenueTransSubscription_SMAStartdate
          ElementPosition     #1227133512
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #SMAStartDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #SMATransDate
          ElementPosition     #306783378
          HierarchyParent     #Subscriptiongrid
          Label               #@SYS54242
          DataSource          #ProjRevenueTransSubscription
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #TransDate
          ElementPosition     #286331152
          HierarchyParent     #EmplGrid
          Label               #@SYS54242
          DataSource          #projEmplTrans
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #TransDate1
          ElementPosition     #306783378
          HierarchyParent     #CostGrid
          Label               #@SYS54242
          DataSource          #projCostTrans
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #TransDate2
          ElementPosition     #429496728
          HierarchyParent     #RevenueGrid
          Label               #@SYS54242
          DataSource          #ProjRevenueTrans
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL DATEEDIT
        PROPERTIES
          Name                #TransDate3
          ElementPosition     #536870910
          HierarchyParent     #OnAccGrid
          DataSource          #projOnAccTrans
          DataField           #TransDate
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlCreateOnAccount
          AutoDeclaration     #Yes
          ElementPosition     #1610612733
          HierarchyParent     #New
          Text                #@SYS340313
          ButtonDisplay       #Text & Image left
          NormalImage         #11037
          ImageLocation       #EmbeddedResource
          MenuItemType        #Action
          MenuItemName        #ProjCreateProposalOnAcc
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    super();
            #
            #    projProposalJour_ds.executeQuery();
            #    projProposalJour_ds.linkActive();
            #    heading.tab(1);
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlCreateProposal
          AutoDeclaration     #Yes
          ElementPosition     #1073741822
          HierarchyParent     #New
          Text                #@SYS77555
          ButtonDisplay       #Text & Image left
          NormalImage         #10583
          ImageLocation       #EmbeddedResource
          MenuItemType        #Action
          MenuItemName        #ProjCreateProposalNormal
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    super();
            #
            #    projProposalJour_ds.executeQuery();
            #    projProposalJour_ds.linkActive();
            #    element.updateRelatedForm();
            #
            #    heading.tab(1);
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlInvoiceUpdate
          AutoDeclaration     #Yes
          Enabled             #No
          ElementPosition     #1610612732
          HierarchyParent     #ButtonGroup3
          Text                #@SYS6098
          ButtonDisplay       #Text & Image left
          NormalImage         #10285
          ImageLocation       #EmbeddedResource
          MultiSelect         #Yes
          DataSource          #ProjProposalJour
          MenuItemType        #Action
          MenuItemName        #ProjFormLetter_Invoice
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    super();
            #
            #    projProposalJour_ds.research();
            #
            #    element.setButtonAccess();
            #
            #    element.updateRelatedForm();
            #
            #    heading.tab(1);
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlPaymentSchedule
          AutoDeclaration     #Yes
          Enabled             #No
          HelpText            #@SYS89895
          ElementPosition     #1879048188
          HierarchyParent     #ButtonGroup3
          ButtonDisplay       #Image only
          NormalImage         #10673
          ImageLocation       #EmbeddedResource
          DataSource          #ProjProposalJour
          MenuItemName        #CustPaymScheduleProjInvoiceProposal
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    CustVendPaymSched   custVendPaymSched;
            #
            #    if (projProposalJour.PaymentSched && !CustPaymSched::exist(projProposalJour.TableId,projProposalJour.RecId))
            #    {
            #        custVendPaymSched = CustVendPaymSched::construct(SysModule::Project, projProposalJour);
            #        custVendPaymSched.copyPaymSched(PaymSched::find(projProposalJour.PaymentSched));
            #        projProposalJour.createPaymentSched();
            #    }
            #
            #    super();
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlTax
          AutoDeclaration     #Yes
          Enabled             #No
          ElementPosition     #805306365
          HierarchyParent     #ButtonGroup3
          ButtonDisplay       #Image only
          NormalImage         #10777
          ImageLocation       #EmbeddedResource
          DataSource          #ProjProposalJour
          MenuItemName        #TaxTrnsSourceProjectInvoiceProposal
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    MenuFunction                menuFunction;
            #    Args                        args = new Args();
            #
            #    if (projProposalJour.LineProperty != ProjLinePropertyCode::Invoiced)
            #    {
            #        if (!tmpTaxTransForm || (tmpTaxTransForm && tmpTaxTransForm.closed()))
            #        {
            #            tmpTaxTransForm = Tax::showTaxes(menuitemDisplayStr(TaxTmpWorkProjectInvoiceProposal), element.getShowTax()
            #                // <GEEU>
            #                , projProposalJour
            #                // </GEEU>
            #                );
            #        }
            #    }
            #    else
            #    {
            #        args.record(projProposalJour);
            #        args.caller(element);
            #
            #        menuFunction = new MenuFunction(menuitemDisplayStr(TaxTrans), MenuItemType::Display);
            #        menuFunction.run(args);
            #    }
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlTotals
          AutoDeclaration     #Yes
          Enabled             #No
          ElementPosition     #1073741820
          HierarchyParent     #ButtonGroup3
          ButtonDisplay       #Image only
          NormalImage         #10832
          ImageLocation       #EmbeddedResource
          DataSource          #ProjProposalJour
          MenuItemName        #ProjInvoiceTotals
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #CtrlUpdateProposal
          AutoDeclaration     #Yes
          Visible             #No
          Enabled             #No
          ElementPosition     #536870910
          HierarchyParent     #ButtonGroup3
          Text                #@SYS54992
          ButtonDisplay       #Text & Image left
          NormalImage         #10009
          ImageLocation       #EmbeddedResource
          MenuItemType        #Action
          MenuItemName        #ProjUpdateProposal
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    ProjProposalJour findRecord = projProposalJour.data();
            #
            #    super();
            #
            #    projProposalJour_Ds.reread();
            #    projProposalJour_Ds.findRecord(findRecord);
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #ProjInvoiceProposalCC
          AutoDeclaration     #Yes
          ElementPosition     #1996488699
          HierarchyParent     #ButtonGroup3
          Text                #@ACC1514
          ButtonDisplay       #Text & Image left
          ShowShortCut        #No
          Primary             #Yes
          KeyTip              #@ACC1775
          DataSource          #ProjProposalJour
          MenuItemName        #ProjInvoiceProposalCC
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #PSAbtPrintPreview
          AutoDeclaration     #Yes
          ElementPosition     #1979711481
          HierarchyParent     #ButtonGroup3
          Text                #@SYS25597
          DataSource          #ProjProposalJour
          MenuItemType        #Action
          MenuItemName        #ProjFormLetter_Invoice
        ENDPROPERTIES
        
        METHODS
          SOURCE #clicked
            #void clicked()
            #{
            #    ProjFormLetter::printPreview(projProposalJour);
            #}
            #
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #PSAIndirectComponents
          AutoDeclaration     #Yes
          ElementPosition     #2063597563
          HierarchyParent     #ButtonGroup3
          Text                #@PSA11466
          DataSource          #ProjProposalEmpl
          MenuItemName        #PSAIndirectComponentTrans
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #PSAProjInvoiceDetails
          AutoDeclaration     #Yes
          ElementPosition     #1946157049
          HierarchyParent     #ButtonGroup3
          DataSource          #ProjProposalJour
          MenuItemName        #PSAProjInvoiceDetails
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL MENUITEMBUTTON
        PROPERTIES
          Name                #TransportationDocument
          ElementPosition     #2013265917
          HierarchyParent     #ButtonGroup3
          ButtonDisplay       #Text & Image left
          NeedsRecord         #Yes
          DataSource          #ProjProposalJour
          MenuItemName        #TransportationDocument
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectCostInvoiceProposal_Qty
          ElementPosition     #1380525201
          HierarchyParent     #CostGrid
          DataSource          #ProjProposalCost
          DataMethod          #Qty
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectEmployeeInvoiceProposal_Qty
          ElementPosition     #1145324608
          HierarchyParent     #EmplGrid
          Label               #@SYS1151
          DataSource          #ProjProposalEmpl
          DataMethod          #Qty
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_DeliverNow
          AutoDeclaration     #Yes
          ElementPosition     #715827880
          HierarchyParent     #Item_SalesLineGrid
          Label               #@SYS59970
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #DeliverNow
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_InventNow
          ElementPosition     #1717986912
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #InventNow
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_RemainAfter
          ElementPosition     #1574821336
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #RemainAfter
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_RemainAfterInvent
          ElementPosition     #2004318064
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #RemainAfterInvent
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjItemProject_Qty
          ElementPosition     #1321528392
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjProposalItem_Project
          DataMethod          #Qty
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalCostDetail_AmountCur
          ElementPosition     #1687308579
          HierarchyParent     #CostGrid
          Label               #@SYS10500
          DataSource          #ProjProposalCostDetail
          DataField           #AmountCur
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalCostDetail_SalesPrice
          ElementPosition     #1533916890
          HierarchyParent     #CostGrid
          Label               #@SYS343154
          DataSource          #ProjProposalCostDetail
          DataField           #SalesPrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalCostDetail_salesPriceInclTax_BR
          ElementPosition     #1610612734
          HierarchyParent     #CostGrid
          DataSource          #ProjProposalCostDetail
          DataMethod          #salesPriceInclTax_BR
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalEmpl_SalesPrice
          AutoDeclaration     #Yes
          ConfigurationKey    #Project3
          ElementPosition     #1288490184
          HierarchyParent     #EmplGrid
          Label               #@SYS343154
          DataSource          #ProjProposalEmpl
          DataMethod          #salesPrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalEmplDetail_AmountCur
          ElementPosition     #1574821336
          HierarchyParent     #EmplGrid
          Label               #@SYS10500
          DataSource          #ProjProposalEmplDetail
          DataField           #AmountCur
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalEmplDetail_SalesPrice
          Visible             #No
          ElementPosition     #1431655760
          HierarchyParent     #EmplGrid
          DataSource          #ProjProposalEmplDetail
          DataField           #SalesPrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalEmplDetail_salesPriceInclTax_BR
          ElementPosition     #1569314965
          HierarchyParent     #EmplGrid
          DataSource          #ProjProposalEmplDetail
          DataMethod          #salesPriceInclTax_BR
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalItemDetail_Project_AmountCur
          ElementPosition     #1651910490
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS10500
          DataSource          #ProjProposalItemDetail_Project
          DataField           #AmountCur
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalItemDetail_Project_SalesPrice
          ElementPosition     #1486719441
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS343154
          DataSource          #ProjProposalItemDetail_Project
          DataField           #SalesPrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalItemDetail_Project_salesPriceInclTax_BR
          ElementPosition     #1569314965
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjProposalItemDetail_Project
          DataMethod          #salesPriceInclTax_BR
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalItemDetail_SalesOrder_LineAmount
          ElementPosition     #1002159032
          HierarchyParent     #Item_SalesLineGrid
          Label               #@SYS10500
          DataSource          #ProjProposalItemDetail_SalesOrder
          DataMethod          #lineAmt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalOnAccDetail_LineAmount
          ElementPosition     #1342177275
          HierarchyParent     #OnAccGrid
          Label               #@SYS10500
          DataSource          #ProjProposalOnAccDetail
          DataMethod          #lineAmount
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalRevenueDetail_LineAmount
          ElementPosition     #1503238548
          HierarchyParent     #RevenueGrid
          Label               #@SYS10500
          DataSource          #ProjProposalRevenueDetail
          DataMethod          #lineAmount
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjProposalRevenueDetailSubscription_AmountCur
          ElementPosition     #1073741823
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjProposalRevenueDetailSubscription
          DataField           #AmountCur
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjRevenueTransSubscription_SMABasePrice
          ElementPosition     #1687308579
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #SMABasePrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #ProjRevenueTransSubscription_SMAIndex
          ElementPosition     #1533916890
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #SMAIndex
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAIndirecCostAmount
          AutoDeclaration     #Yes
          Visible             #No
          AllowEdit           #No
          Width               #Column width
          ElementPosition     #1486719441
          HierarchyParent     #SummaryGrid
          Label               #@PSA11598
          DataSource          #PSAProjProposalProj
          DataMethod          #calcTotalIndirectComponentInvoice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSANowInvoiced
          AllowEdit           #No
          Width               #Column width
          ElementPosition     #1982292588
          HierarchyParent     #SummaryGrid
          Label               #@PSA11385
          DataSource          #PSAProjProposalProj
          DataMethod          #calcTotalLineAmount
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_Invoiced
          Width               #Column width
          ElementPosition     #991146294
          HierarchyParent     #SummaryGrid
          Label               #@PSA11389
          DataSource          #PSAProjProposalProj
          DataField           #Invoiced
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_InvoicedNow
          Width               #Column width
          ElementPosition     #1156337343
          HierarchyParent     #SummaryGrid
          Label               #@SYS10500
          DataSource          #PSAProjProposalProj
          DataField           #InvoicedNow
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_ReleasedAmount
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #1321528392
          HierarchyParent     #SummaryGrid
          DataSource          #PSAProjProposalProj
          DataField           #ReleasedAmount
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_RetainedNow
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #1817101539
          HierarchyParent     #SummaryGrid
          Label               #@PSA11413
          DataSource          #PSAProjProposalProj
          DataField           #RetainedNow
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_RetainedPercent
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #1651910490
          HierarchyParent     #SummaryGrid
          Label               #@PSA11454
          DataSource          #PSAProjProposalProj
          DataField           #RetainedPercent
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL REALEDIT
        PROPERTIES
          Name                #SalesLine_SalesPrice
          AutoDeclaration     #Yes
          ElementPosition     #858993456
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #SalesLine
          DataField           #SalesPrice
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #BillingRuleName
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #825955245
          HierarchyParent     #SummaryGrid
          DataSource          #PSAProjProposalProj
          DataMethod          #BillingRuleName
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #Category2
          ElementPosition     #858993456
          HierarchyParent     #RevenueGrid
          Label               #@SYS333196
          DataSource          #ProjRevenueTrans
          DataField           #CategoryId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #CategoryId
          ElementPosition     #613566756
          HierarchyParent     #CostGrid
          Label               #@SYS333196
          DataSource          #projCostTrans
          DataField           #CategoryId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #CostTxt
          ElementPosition     #1227133512
          HierarchyParent     #CostGrid
          Label               #@SYS13566
          DataSource          #ProjProposalCost
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #CustInvoiceTable_CustBankAccountId
          ElementPosition     #1717986916
          HierarchyParent     #HeadVAT
          DataSource          #ProjProposalJour
          DataField           #CustBankAccountId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #displayVATRegistrationNum
          ElementPosition     #1288490187
          HierarchyParent     #HeadVAT
          DataSource          #ProjProposalJour
          DataMethod          #dispVATRegistrationNum
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #EmplTxt
          Width               #75
          ElementPosition     #1002159032
          HierarchyParent     #EmplGrid
          Label               #@SYS13566
          DataSource          #ProjProposalEmpl
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #OnAccTxt
          ElementPosition     #1073741820
          HierarchyParent     #OnAccGrid
          Label               #@SYS13566
          DataSource          #ProjProposalOnAcc
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #projCostTrans_ActivityNumber
          ElementPosition     #766958445
          HierarchyParent     #CostGrid
          Label               #@SYS38381
          DataSource          #projCostTrans
          DataField           #ActivityNumber
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectCostInvoiceProposal_Project
          AllowEdit           #No
          ElementPosition     #460175067
          HierarchyParent     #CostGrid
          Label               #@SYS80304
          DataSource          #projCostTrans
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectEmployeeInvoiceProposal_Project
          ElementPosition     #429496728
          HierarchyParent     #EmplGrid
          Label               #@SYS80304
          DataSource          #projEmplTrans
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectInvoiceProposalJour_CurrencyCode
          AutoDeclaration     #Yes
          AllowEdit           #No
          ElementPosition     #631612835
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #CurrencyId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectInvoiceProposalJour_InvoiceNum
          AllowEdit           #No
          ElementPosition     #1010580536
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #ProjInvoiceId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectInvoiceProposalJour_LedgerVoucher
          AutoDeclaration     #Yes
          AllowEdit           #No
          ElementPosition     #1263225670
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #LedgerVoucher
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectInvoiceProposalJour_Project
          ElementPosition     #252645134
          HierarchyParent     #PrijInvoiceProposalGrid
          Label               #@SYS50055
          DataSource          #ProjProposalJour
          DataField           #ProjInvoiceProjId
        ENDPROPERTIES
        
        METHODS
          SOURCE #modified
            #boolean modified()
            #{
            #    boolean ret;
            #
            #    ret = super();
            #
            #    if (ret)
            #    {
            #        projProposalJour.CurrencyId = ProjInvoiceTable::find(projProposalJour.ProjInvoiceProjId).CurrencyId;
            #    }
            #
            #    return ret;
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_ItemId
          AllowEdit           #No
          ElementPosition     #429496728
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #ItemId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_ProjId
          AllowEdit           #No
          ElementPosition     #286331152
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataMethod          #projId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectItemInvoiceProposal_SalesOrderNum
          AllowEdit           #No
          ElementPosition     #1145324608
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #SalesId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectOnAccountInvoiceProposal_Project
          AllowEdit           #No
          ElementPosition     #805306365
          HierarchyParent     #OnAccGrid
          Label               #@SYS80304
          DataSource          #projOnAccTrans
          DataField           #ProjID
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjectRevenueInvoiceProposal_Project
          ElementPosition     #644245092
          HierarchyParent     #RevenueGrid
          Label               #@SYS80304
          DataSource          #ProjRevenueTrans
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #projEmplTrans_ActivityNumber
          ElementPosition     #715827880
          HierarchyParent     #EmplGrid
          Label               #@SYS38381
          DataSource          #projEmplTrans
          DataField           #ActivityNumber
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #projEmplTrans_CategoryId
          ElementPosition     #572662304
          HierarchyParent     #EmplGrid
          Label               #@SYS333196
          DataSource          #projEmplTrans
          DataField           #CategoryId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #projEmplTrans_PSAIndirectComponentGroup
          Visible             #No
          ConfigurationKey    #PSAIndirectCost
          ElementPosition     #2004318067
          HierarchyParent     #EmplGrid
          DataSource          #projEmplTrans
          DataField           #PSAIndirectComponentGroup
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjItemProject_ActivityNumber
          ElementPosition     #991146294
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS38381
          DataSource          #ProjItemTrans_Project
          DataField           #ActivityNumber
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjItemProject_CategoryId
          ElementPosition     #660764196
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS333196
          DataSource          #ProjItemTrans_Project
          DataField           #CategoryId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjItemProject_ProjId
          AllowEdit           #No
          ElementPosition     #495573147
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS80304
          DataSource          #ProjItemTrans_Project
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjItemProject_Txt
          Height              #1
          ElementPosition     #1156337343
          HierarchyParent     #ItemProjectGrid
          Label               #@SYS13566
          DataSource          #ProjProposalItem_Project
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjItemTrans_Project_ItemId
          ElementPosition     #825955245
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjItemTrans_Project
          DataField           #ItemId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalCost_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1840700268
          HierarchyParent     #CostGrid
          DataSource          #ProjProposalCost
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalCost_TransId
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1994091957
          HierarchyParent     #CostGrid
          DataSource          #ProjProposalCost
          DataField           #TransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalEmpl_EInvoiceAccountCode
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1717986912
          HierarchyParent     #EmplGrid
          DataSource          #ProjProposalEmpl
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalEmpl_TransId
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1861152488
          HierarchyParent     #EmplGrid
          DataSource          #ProjProposalEmpl
          DataField           #TransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalItem_Project_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1817101539
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjProposalItem_Project
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalItem_Project_ProjTransId
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1982292588
          HierarchyParent     #ItemProjectGrid
          DataSource          #ProjProposalItem_Project
          DataField           #ProjTransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalItem_SalesOrder_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1861152488
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalItem_SalesOrder_ProjTransId
          AutoDeclaration     #Yes
          ElementPosition     #1288490184
          HierarchyParent     #Item_SalesLineGrid
          DataSource          #ProjProposalItem_SalesOrder
          DataField           #ProjTransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalJour_Description
          Visible             #No
          ConfigurationKey    #Project3
          ElementPosition     #1979053553
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #Description
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalJour_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1642193371
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalJour_InvoiceAccount
          AutoDeclaration     #Yes
          ElementPosition     #442128984
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #InvoiceAccount
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalOnAcc_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1610612730
          HierarchyParent     #OnAccGrid
          DataSource          #ProjProposalOnAcc
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalOnAcc_TransId
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1879048185
          HierarchyParent     #OnAccGrid
          DataSource          #ProjProposalOnAcc
          DataField           #TransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalRevenue_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1717986912
          HierarchyParent     #RevenueGrid
          DataSource          #ProjProposalRevenue
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalRevenue_TransId
          AutoDeclaration     #Yes
          Visible             #No
          ElementPosition     #1932735276
          HierarchyParent     #RevenueGrid
          DataSource          #ProjProposalRevenue
          DataField           #TransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalRevenueSubscription_EInvoiceAccountCode
          AutoDeclaration     #Yes
          ElementPosition     #1840700268
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjProposalRevenueSubscription
          DataField           #EInvoiceAccountCode
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalRevenueSubscription_TransId
          AutoDeclaration     #Yes
          ElementPosition     #1994091957
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjProposalRevenueSubscription
          DataField           #TransId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjProposalRevenueSubscription_Txt
          ElementPosition     #920350134
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjProposalRevenueSubscription
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #ProjRevenueTransSubscription_SMASubscriptionId
          ElementPosition     #766958445
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #SMASubscriptionId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #Proposal
          AllowEdit           #No
          ElementPosition     #378967701
          HierarchyParent     #PrijInvoiceProposalGrid
          DataSource          #ProjProposalJour
          DataField           #ProposalId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_ContractLineNum
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #660764196
          HierarchyParent     #SummaryGrid
          DataSource          #PSAProjProposalProj
          DataField           #ContractLineNum
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_Name
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #495573147
          HierarchyParent     #SummaryGrid
          DataSource          #PSAProjProposalProj
          DataMethod          #projName
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #PSAProjProposalProj_ProjId
          AutoDeclaration     #Yes
          Width               #Column width
          ElementPosition     #330382098
          HierarchyParent     #SummaryGrid
          Label               #@SYS80304
          DataSource          #PSAProjProposalProj
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #Reason_M_editReasonCode
          HelpText            #@GLS221842
          ElementPosition     #1073741822
          HierarchyParent     #Reason
          DataSource          #ProjProposalJour
          DataMethod          #editReasonCode
        ENDPROPERTIES
        
        METHODS
          SOURCE #lookup
            #public void lookup()
            #{
            #    ReasonFormTable::reasonCodeLookup(this,
            #            LedgerJournalACType::Cust, LedgerJournalACType::Cust, true);
            #}
          ENDSOURCE
          SOURCE #modified
            #// <GEEU>
            #public boolean modified()
            #{
            #    boolean changed = super();
            #
            #    if(changed)
            #    {
            #        // Needed since the change is actually on the ReasonTableRef table,
            #        // the ReasonTableRef (RecId) doesn't changes on update.
            #        projProposalJour_ds.forceWrite(true);
            #    }
            #
            #    return changed;
            #}
            #// </GEEU>
            #
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #Reason_M_editReasonComment
          HelpText            #@GLS221843
          ElementPosition     #1610612733
          HierarchyParent     #Reason
          Label               #@SYS53151
          DataSource          #ProjProposalJour
          DataMethod          #editReasonComment
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #SalesLine_Name
          Height              #1
          ElementPosition     #572662304
          HierarchyParent     #Item_SalesLineGrid
          Label               #@SYS13566
          DataSource          #SalesLine
          DataField           #Name
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #SelectProjId
          AutoDeclaration     #Yes
          Width               #120
          ConfigurationKey    #Project3
          ElementPosition     #1227133512
          HierarchyParent     #OptionGroup
          Label               #@SYS105983
        ENDPROPERTIES
        
        METHODS
          SOURCE #lookup
            #public void lookup()
            #{
            #    SysTableLookup          oSysTableLookup;
            #    Query                   oQuery = new Query();
            #    QueryBuildDataSource    oQueryBuildDataSource;
            #    QueryBuildRange         oQueryBuildRange;
            #
            #    if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
            #    {
            #        oSysTableLookup = SysTableLookup::newParameters(tableNum(ProjTable), this);
            #
            #        oQueryBuildDataSource = oQuery.addDataSource(tableNum(ProjTable));
            #
            #        oQueryBuildRange = oQueryBuildDataSource.addRange(fieldNum(ProjTable, ProjInvoiceProjId));
            #
            #        if (selectProjInvoiceProjId.valueStr())
            #        {
            #            oQueryBuildRange.value(queryValue(selectProjInvoiceProjId.valueStr()));
            #        }
            #
            #        oSysTableLookup.addLookupfield(fieldNum(ProjTable, CustAccount));
            #        oSysTableLookup.setLabel("@SYS110422");
            #        oSysTableLookup.addLookupMethod('CustName');
            #        oSysTableLookup.setLabel("@SYS120466");
            #        oSysTableLookup.addLookupfield(fieldNum(ProjTable, ProjId),true);
            #        oSysTableLookup.setLabel("@SYS105983");
            #        oSysTableLookup.addLookupfield(fieldNum(ProjTable, Name));
            #        oSysTableLookup.addLookupfield(fieldNum(ProjTable, ProjGroupId));
            #        oSysTableLookup.addLookupfield(fieldNum(ProjTable, Type));
            #
            #        oSysTableLookup.parmQuery(oQuery);
            #        oSysTableLookup.performFormLookup();
            #    }
            #}
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #SelectProjInvoiceProjId
          AutoDeclaration     #Yes
          Width               #120
          ConfigurationKey    #Project3
          ElementPosition     #920350134
          HierarchyParent     #OptionGroup
          Label               #@SYS50055
        ENDPROPERTIES
        
        METHODS
          SOURCE #lookup
            #public void lookup()
            #{
            #    SysTableLookup          sysTableLookup = SysTableLookup::newParameters(tableNum(ProjInvoiceTable), this);
            #    Query                   query = new Query();
            #    QueryBuildRange         oqbrContractLines;
            #    QueryBuildDataSource    oqbdS;
            #
            #    if (isConfigurationkeyEnabled(configurationKeyNum(PSAContractLine)))
            #    {
            #        oqbdS = query.addDataSource(tableNum(ProjInvoiceTable));
            #        oqbrContractLines = oqbdS.addRange(fieldNum(ProjInvoiceTable, psaContractLines));
            #        oqbrContractLines.value(queryValue(NoYes::No));
            #
            #        sysTableLookup.addLookupfield(fieldNum(ProjInvoiceTable, ProjInvoiceProjId));
            #        sysTableLookup.setLabel("@SYS50055");
            #        sysTableLookup.addLookupfield(fieldNum(ProjInvoiceTable, Name));
            #        sysTableLookup.setLabel("@SYS92116");
            #        sysTableLookup.parmQuery(query);
            #        sysTableLookup.performFormLookup();
            #    }
            #    else if (isConfigurationkeyEnabled(configurationKeyNum(Project3)))
            #    {
            #        ProjInvoiceTable::psaLookupProjInvoiceProjId(this);
            #    }
            #}
            #
          ENDSOURCE
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #SMACategory
          ElementPosition     #613566756
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #CategoryId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #SMAProjectRevenueInvoiceProposal_Project
          ElementPosition     #460175067
          HierarchyParent     #Subscriptiongrid
          DataSource          #ProjRevenueTransSubscription
          DataField           #ProjId
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
      CONTROL STRINGEDIT
        PROPERTIES
          Name                #Txt1
          HelpText            #@SYS75151
          ElementPosition     #1288490184
          HierarchyParent     #RevenueGrid
          Label               #@SYS13566
          DataSource          #ProjProposalRevenue
          DataField           #Txt
        ENDPROPERTIES
        
        METHODS
        ENDMETHODS
      ENDCONTROL 
      
    ENDCONTAINER
    
  ENDDESIGN
  
  PERMISSIONS #Permissions
    PROPERTIES
    ENDPROPERTIES
    
    PERMISSIONSET #Read
      PROPERTIES
      ENDPROPERTIES
      
      FORM #Controls
      ENDFORM
      
    TABLES #Tables
    ENDTABLES
    
  SERVERMETHODS #Server Methods
  ENDSERVERMETHODS
  
ASSOCIATEDFORMS #Associated Forms
  ASSOCIATEDFORM #ProjInvoiceEditLines
    PROPERTIES
      Form                #ProjInvoiceEditLines
      AccessLevel         #NoAccess
      SystemManaged       #No
      ManagedBy           #Manual
    ENDPROPERTIES
    
  ENDASSOCIATEDFORM
  
ENDASSOCIATEDFORMS

ENDPERMISSIONSET

PERMISSIONSET #Update
  PROPERTIES
  ENDPROPERTIES
  
  FORM #Controls
  ENDFORM
  
TABLES #Tables
ENDTABLES

SERVERMETHODS #Server Methods
ENDSERVERMETHODS

ASSOCIATEDFORMS #Associated Forms
  ASSOCIATEDFORM #ProjInvoiceEditLines
    PROPERTIES
      Form                #ProjInvoiceEditLines
      AccessLevel         #Update
      SystemManaged       #No
      ManagedBy           #Manual
    ENDPROPERTIES
    
  ENDASSOCIATEDFORM
  
ENDASSOCIATEDFORMS

ENDPERMISSIONSET

PERMISSIONSET #Create
  PROPERTIES
  ENDPROPERTIES
  
  FORM #Controls
  ENDFORM
  
TABLES #Tables
ENDTABLES

SERVERMETHODS #Server Methods
ENDSERVERMETHODS

ASSOCIATEDFORMS #Associated Forms
  ASSOCIATEDFORM #ProjInvoiceEditLines
    PROPERTIES
      Form                #ProjInvoiceEditLines
      AccessLevel         #Create
      SystemManaged       #No
      ManagedBy           #Manual
    ENDPROPERTIES
    
  ENDASSOCIATEDFORM
  
ENDASSOCIATEDFORMS

ENDPERMISSIONSET

PERMISSIONSET #Delete
  PROPERTIES
  ENDPROPERTIES
  
  FORM #Controls
  ENDFORM
  
TABLES #Tables
ENDTABLES

SERVERMETHODS #Server Methods
ENDSERVERMETHODS

ASSOCIATEDFORMS #Associated Forms
  ASSOCIATEDFORM #ProjInvoiceEditLines
    PROPERTIES
      Form                #ProjInvoiceEditLines
      AccessLevel         #Delete
      SystemManaged       #No
      ManagedBy           #Manual
    ENDPROPERTIES
    
  ENDASSOCIATEDFORM
  
ENDASSOCIATEDFORMS

ENDPERMISSIONSET

ENDPERMISSIONS

ENDFORM


***Element: END
